<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]>
<html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="zh">
<!--<![endif]-->

<!-- BEGIN HEAD -->
<head>
    <title>IC卡销售统计</title>
    <script src="../pages/scripts/basepath.js"></script>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-select/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/select2/select2.css">
    <script src="../pages/scripts/header.js"></script>
    <meta http-equiv="content-type" content="text/html" charset="utf-8"/>
    <link href='../assets/global/plugins/jquery-watable/watable.css' rel='stylesheet'/>
    <link href='../assets/global/plugins/jquery-watable/animate.min.css' rel='stylesheet'/>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css"/>
    <link href='../assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css' rel='stylesheet'/>

    <!--datapicker css start-->
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-datepicker/css/datepicker3.css"/>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css"/>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-colorpicker/css/colorpicker.css"/>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css"/>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css"/>
    <!--datapicker end-->

    <link rel="stylesheet" href="/statement/css/3.3.7/bootstrap.min.css">
    <link href='../assets/global/css/bootstrap-monthpicker.css' rel='stylesheet'/>
    <!-- END THEME STYLES -->
    <style>
        @media print {
            .noneprint {
                display: none;
            }
        }

        .tabPrint td {
            border-left: #000000 solid 1px;
            border-top: #000000 solid 1px;
            height: 21px;
        }

        table.tabPrint {
            border-right: #000000 solid 1px;
            border-bottom: #000000 solid 1px;
        }

        .nextPage {
            page-break-after: always;
        }

        .linetd {
            border-bottom: solid 1px #000;
        }
    </style>
</head>
<!-- END HEAD -->

<body class="page-header-fixed page-quick-sidebar-over-content">

<!-- 标题栏开始 -->
<div class="page-header navbar navbar-fixed-top">
    <script>$.include("pages/partial/menu.shtml");</script>
</div>
<!-- 标题栏结束 -->
<div class="clearfix"></div>
<div class="page-container">
    <!-- 左侧菜单开始 -->
    <div class="page-sidebar-wrapper">
        <script>$.include("pages/partial/sidebar.shtml");</script>
    </div>
    <!-- 左侧菜单结束 -->

    <!-- 主内容开始 -->
    <div class="page-content-wrapper">
        <div class="page-content">
            <!--内容头开始-->
            <!--内容头开始-->
            <div class="row noneprint">
                <div class="col-md-12">
                    <ul class="page-breadcrumb breadcrumb">
                        <li>
                            <i class="fa fa-map-marker"></i>
                            <a href="index.html">报表统计</a>
                            <i class="fa fa-angle-right"></i>
                        </li>
                        <li>
                            <a href="javascript:void(0)">IC卡销售统计</a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- 内容头结束-->

            <!-- 内容开始-->

            <div class="container col-sm-12 noneprint" style="padding-bottom:0px">
                <div class="row">

                    <div class="col-sm-3 form-group">
                        <div class="btn-group input-group">
                            <div class="input-group-addon" style="border:0px;">月份：</div>
                            <div id="div_date" class="input-group input-daterange" data-date="11/2012" data-date-format="yyyy年mm月">
                                <input id="find_date" type="text" class="form-control" name="from">
                                <span class="inputclear glyphicon glyphicon-remove-circle hidden" ></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-3 form-group">
                    </div>
                    <div class="col-sm-3 form-group">
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <button id="find_sign" type="button" class="btn yellow">
                                查询 <i class="fa fa-search"></i>
                            </button>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <button id="btn_print_page" onclick="window.print()" type="button" class="btn gray disabled" >
                                打印<i class="glyphicon"></i>
                            </button>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <button id="btn_down_detail" type="button" class="btn gray disabled export-excel">
                                导出<i class="glyphicon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 内容头结束-->

            <div class="container-fluid">
                <div>
                    <table cellSpacing="0" cellPadding="2" width="100%" align="center" border="0">
                        <tr>
                            <td id="title" align="center" title="">IC卡销售统计</td>
                        </tr>
                    </table>
                </div>
                <br/>
                <table class="tabPrint table-bordered table-hover table-condensed " align="center" width="100%" cellSpacing="0" cellPadding="0" border="0"
                       ID="Table2">
                    <thead style="display:table-header-group;font-weight:bold"
                           mce_style="display:table-header-group;font-weight:bold">
                    <tr align="center">
                        <td id="thead_r1_c1" rowspan="1" colspan="2">指标值</td>
                        <!-- <td id="thead_r1_c3" rowspan="1" colspan="1">管理户数</td> -->
                        <td id="thead_r1_c4" rowspan="1" colspan="1">长期不用户数</td>
                        <td id="thead_r1_c5" rowspan="1" colspan="1">已开栓户数</td>
                        <td id="thead_r1_c6" rowspan="1" colspan="1">正常用气户数</td>
                        <td id="thead_r1_c7" rowspan="1" colspan="1">暂停客户数</td>
                        <td id="thead_r1_c8" rowspan="1" colspan="1">拆除客户数</td>
                        <!-- <td id="thead_r1_c9" rowspan="1" colspan="1">未开栓户</td> -->
                        <td id="thead_r1_c10" rowspan="1" colspan="1">本月新换ic卡客户数 </td>
                        <td id="thead_r1_c11" rowspan="1" colspan="1">本月暂停客户数</td>
                        <td id="thead_r1_c12" rowspan="1" colspan="1">本月暂停表户数</td>
                        <td id="thead_r1_c13" rowspan="1" colspan="1">本年暂停客户数</td>
                        <td id="thead_r1_c14" rowspan="1" colspan="1">本年暂停表户数</td>
                        <td id="thead_r1_c15" rowspan="1" colspan="1">本月拆除客户数</td>
                        <td id="thead_r1_c16" rowspan="1" colspan="1">年度拆除客户数</td>
                        <td id="thead_r1_c17" rowspan="1" colspan="1">本月拆除表户数</td>
                        <td id="thead_r1_c18" rowspan="1" colspan="1">年度拆除表户数</td>
                        <td id="thead_r1_c19" rowspan="1" colspan="1">抄表量</td>
                        <td id="thead_r1_c20" rowspan="1" colspan="1">累计抄表量</td>
                        <td id="thead_r1_c21" rowspan="1" colspan="1">计费量</td>
                        <td id="thead_r1_c22" rowspan="1" colspan="1">累计计费量</td>
                        <td id="thead_r1_c23" rowspan="1" colspan="1">计费额</td>
                        <td id="thead_r1_c24" rowspan="1" colspan="1">累计计费额</td>
                        <td id="thead_r1_c25" rowspan="1" colspan="1">追补量</td>
                        <td id="thead_r1_c26" rowspan="1" colspan="1">累计追补量</td>
                        <td id="thead_r1_c27" rowspan="1" colspan="1">追补额</td>
                        <td id="thead_r1_c28" rowspan="1" colspan="1">累计追补额</td>
                        <!-- <td id="thead_r1_c29" rowspan="1" colspan="1">减免额</td>
                        <td id="thead_r1_c30" rowspan="1" colspan="1">累计减免额</td>
                        <td id="thead_r1_c31" rowspan="1" colspan="1">减免量</td>
                        <td id="thead_r1_c32" rowspan="1" colspan="1">累计减免量</td> -->
                        <!-- <td id="thead_r1_c33" rowspan="1" colspan="1">余额转换量</td> -->
                        <td id="thead_r1_c34" rowspan="1" colspan="1">抄表户</td>
                        <td id="thead_r1_c35" rowspan="1" colspan="1">计费户</td>
                        <!-- <td id="thead_r1_c36" rowspan="1" colspan="1">余额转换户</td> -->
                        <td id="thead_r1_c37" rowspan="1" colspan="1">卡内余量</td>
                        <td id="thead_r1_c38" rowspan="1" colspan="1">余额为0户数</td>
                    </tr>
                    </thead>
                    <tbody id="tbody">
                        <tr align="center">
                            <td id="tbody_r1_c1" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c2" rowspan="1" colspan="1"></td>
                            <!-- <td id="tbody_r1_c3" rowspan="1" colspan="1"></td> -->
                            <td id="tbody_r1_c4" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c5" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c6" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c7" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c8" rowspan="1" colspan="1"></td>
                            <!-- <td id="tbody_r1_c9" rowspan="1" colspan="1"></td> -->
                            <td id="tbody_r1_c10" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c11" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c12" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c13" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c14" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c15" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c16" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c17" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c18" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c19" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c20" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c21" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c22" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c23" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c24" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c25" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c26" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c27" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c28" rowspan="1" colspan="1"></td>
                            <!-- <td id="tbody_r1_c29" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c30" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c31" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c32" rowspan="1" colspan="1"></td> -->
                            <!-- <td id="tbody_r1_c33" rowspan="1" colspan="1"></td> -->
                            <td id="tbody_r1_c34" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c35" rowspan="1" colspan="1"></td>
                            <!-- <td id="tbody_r1_c36" rowspan="1" colspan="1"></td> -->
                            <td id="tbody_r1_c37" rowspan="1" colspan="1"></td>
                            <td id="tbody_r1_c38" rowspan="1" colspan="1"></td>
                        </tr>
                    </tbody>
                </table>
                <br/><br/>
                <br/><br/></div>
            <!-- 内容结束-->
        </div>
    </div>
    <!-- 主内容结束 -->
</div>

<!-- 底边栏开始 -->
<script>$.include("pages/partial/foot.shtml");</script>
<!-- 底边栏结束 -->
</body>


<script>$.include("pages/partial/scripts.shtml");</script>
<!--跳到原稿-->
<script src="../assets/global/plugins/jquery.cokie.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../assets/global/plugins/jquery-watable/jquery.watable.js"></script>
<script type="text/javascript" src="../pages/scripts/rqlbuilder.js"></script>
<script type="text/javascript" src="../pages/scripts/xwatable.js"></script>
<script type="text/javascript" src="../pages/scripts/refhelper.js"></script>

<!--datapicker start-->
<script type="text/javascript" src="../assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script type="text/javascript"
        src="../assets/global/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
<script type="text/javascript" src="../assets/global/plugins/clockface/js/clockface.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-daterangepicker/moment.min.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="../assets/admin/pages/scripts/components-pickers.js"></script>

<script type="text/javascript" src="../assets/global/plugins/select2/select2.js"></script>
<script type="text/javascript" src="../assets/global/scripts/bootstrap-monthpicker.js"></script>


<script src="/statement/js/libs/js-xlsx/xlsx.core.min.js" type="text/javascript"></script>
<script src="/statement/js/libs/html2canvas/html2canvas.min.js" type="text/javascript"></script>
<script src="/statement/js/tableExport.js" type="text/javascript"></script>
<script src="/statement/js/tableExport.js" type="text/javascript"></script>
<script src="/statement/js/datehelper.js" type="text/javascript"></script>

<script type="text/javascript">

    $(".export-excel").attr("data-table",".tabPrint");
    //    $(".export-excel").attr("data-filename","");
    $(".export-excel").on("click", function (e) {
        e.preventDefault();
        var exportTable = $(this).data("table");
        var filename = $("#title").html();//$(this).data("filename");
        var ignoreColumn = "";//$(this).data("ignorecolumn");
        $(exportTable).tableExport({
            fileName: filename,
            type: 'excel',
            escape: 'false',
            excelstyles: ['border-bottom', 'border-top', 'border-left', 'border-right'],
            ignoreColumn: '[' + ignoreColumn + ']'
        });
    });

    jQuery(document).ready(function () {
        ComponentsPickers.init();
        $('#find_date').bootstrapMonthpicker();
        
        // ComponentsDropdowns.init();
    });

    document.onkeydown = function () {keydown();};
    function keydown() {
        //P 空格 会车 event.keyCode==80 || event.keyCode==32 || event.keyCode==13
        if (event.keyCode == 13) {
            window.print();
        }
    }

    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null)return decodeURIComponent(r[2]);
        return null;
    }

    function toAmount(amount) {
        var numArray = amount.toString().split(".");

        if (numArray.length > 1) {
            console.log("##amount="+amount+"##"+amount.toString().split(".").length+"##"+numArray[1].length);
            if (numArray[1].length < 2) {
                amount = amount + "0";
            }else if (numArray[1].length > 2) {
                amount = numArray[0] + "." + numArray[1].substring(0, 2);
            }
        } else {
            amount = amount + ".00";
        }
        //return (amount * 1);//字符串变数字
        return amount;
    }

    function date_format(date, fmt) {
        var dataJson = {
            "M+": date.getMonth() + 1, //月份
            "d+": date.getDate(), //日
            "h+": date.getHours(), //小时
            "m+": date.getMinutes(), //分
            "s+": date.getSeconds(), //秒
            "q+": Math.floor((date.getMonth() + 3) / 3), //季度
            "S": date.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (date.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in dataJson)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (dataJson[k]) : (("00" + dataJson[k]).substr(("" + dataJson[k]).length)));
        return fmt;
    }

    function edit(id) {
        var v = $("#"+id).html();
        $("#"+id).html("<input type='number' id='"+id+"_text' oldid='"+id+"' oldvalue='"+v+"' value='"+v+"' onblur='outEdit(this.id)'/>");
        $("#"+id+"_text").focus();
    }
    function outEdit(id) {
        var ov = $("#"+id).attr("oldvalue");
        var oid = $("#"+id).attr("oldid");
        $("#"+oid).html($("#"+id).val());
    }

    
    function operationData(operationDataJson) {
        for (var i = 0; i < operationDataJson.length; i++) {
            var inputCols = operationDataJson[i].ic;
            var operator = operationDataJson[i].op;
            var out = $("#tbody_" + inputCols[0]).html() * 1;
            for (var j = 1; j < inputCols.length; j++) {
                var value = $("#tbody_" + inputCols[j]).html() * 1;
                if (operator == "+") {
                    out = out + value;
                }
            }
            var outputColType = operationDataJson[i].ty;
            var outputCol = operationDataJson[i].oc;
            if (outputColType && outputColType == "f") {
                $("#tbody_" + outputCol).html(toAmount(out + ""));
            } else {
                $("#tbody_" + outputCol).html(out);
            }

        }
    }
    function getReportArchiveNum(data,areaid,gastypeid){
        //建档数,拆除数,未开栓数,暂停数,拆除数,长期不用数
        var nouseNum=0,normalNum=0,stopNum=0,dismantleNum=0,longuseNum=0;
        //00=未开栓,01=正常 ,02=暂停,03=拆除,04=长期不用,99=逻辑删除
        var nouse="00",normal="01",stop="02",dismantle="03",longnouse="04";
        if(data){
            data.forEach(function(o){
                if(o.areaId && o.gasTypeId){  
                    if(o.areaId==areaid){
                        if(o.gasTypeId.length>2){
                            if(o.gasTypeId.substring(0,3)==gastypeid) {
                                nouseNum+=o.noUseNum;
                                normalNum+=o.normalNum;
                                stopNum+=o.stopNum;
                                dismantleNum+=o.dismantleNum;
                                longuseNum+=o.longUseNum;
                            }
                        }
                    } 
                } 
            });
        }
        
        return {nouseNum:nouseNum,normalNum:normalNum,stopNum:stopNum,dismantleNum:dismantleNum,longuseNum:longuseNum,areaid:areaid,gastypeid:gastypeid};                           
    }
    function toZero(num){
        return num;
        if(!num)return "<font style='color:#eee'>0</font>";
        else if(num=="0.00" || num=="0.0000"){
            return "<font style='color:#eee'>"+num+"</font>"
        }else{
            return num;
        } 
    }
    //核算本月IC新增
    function getArchiveIcNum(data,areaid,gastypeid){
        var num=0;
        if(data){
            data.forEach(function(o){
                if(o.gasTypeId && o.areaId){    
                    if(o.gasTypeId.length>2){
                        //建档案数
                        if(o.gasTypeId.substring(0,3)==gastypeid && o.areaId==areaid){ 
                            if(o.ctmNum)num+=o.ctmNum;
                        }
                    }
                }
            });
        }
        
        return num;
    }
    $(function () {
        $("#find_date").val(date_format(new Date(),"yyyy-MM"));
        $("#title").html($("#find_date").val()+"&nbsp;&nbsp;IC卡销售统计");
        //获取供气区域
        var areas = new Array();
        var area_id = JSON.parse(localStorage.getItem("user_info")).area_id;
        areas.push(area_id);
        //查询areaId下级areaId
        var queryCondion = RQLBuilder.and([
            RQLBuilder.equal("status", "1"),
            RQLBuilder.equal("parentAreaId", area_id)
        ]).rql()
        $.ajax({
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            type: 'get',
            async: false,
            url: hzq_rest + "gasbizarea?query=" + queryCondion,
            success: function (data) {
                for (var i = 0; i < data.length; i++) {
                    areas.push(data[i].areaId);
                }
            }
        });
        var AreaHelper1 = RefHelper.create({
            ref_url: 'gasbizarea?query={"areaId":{"$in":' + JSON.stringify(areas) + '}}',
            ref_col: "areaId",
            ref_display: "areaName",
            "sort": "posCode"
        });
        var gsData = AreaHelper1.getRawData();
        var gs=[];
        gsData.forEach(function(o){
            // if(o.areaId!='23' && o.areaId!='18' && o.areaId!='11' && o.areaId!='21' && o.areaId!='1'){
                gs.push(o);
            // }
        })
        
        var tbody = "";
        $.ajax({
            url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            data: JSON.stringify({
                cols: "gasTypeId,gasTypeName",
                froms: "gasBizGasType",
                wheres: " posCode = 0 and length(gasTypeCode)=3 order by gasTypeCode",
                page: "false"
            }),
            dataType: "json",
            success: function (data) {                
                var cy=data.rows;
                cy.push({gasTypeName:"小计",gasTypeId:-1});
                
                for (var i = 0; i < gs.length; i++) {
                    for (var j = 0; j < cy.length; j++) {
                        var color=""
                        if(cy[j].gasTypeId==-1)color="background-color:#eee";
                        if (j == 0) {
                            tbody = tbody + '<tr align="center" data-areaId="'+gs[i].areaId+'" data-gasTypeId="'+cy[j].gasTypeId+'">' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c1" rowspan="'+cy.length+'" colspan="1"><b>' +gs[i].areaName + '</b></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c2" rowspan="1" colspan="1"><b>' + cy[j].gasTypeName + '</b></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c3" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c4" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c5" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c6" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c7" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c8" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c9" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c10" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c11" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c12" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c13" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c14" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c15" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c16" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c17" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c18" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c19" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c20" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c21" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c22" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c23" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c24" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c25" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c26" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c27" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c28" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c29" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c30" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c31" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c32" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c33" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c34" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c35" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c36" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c37" rowspan="1" colspan="1"></td>' +
                            '</tr>';
                        } else {
                            tbody = tbody + '<tr align="center" data-areaId="'+gs[i].areaId+'" data-gasTypeId="'+cy[j].gasTypeId+'" style="'+color+'">' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c2" rowspan="1" colspan="1"><b>' + cy[j].gasTypeName + '</b></td>' +
                                /* '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c3" rowspan="1" colspan="1"></td>' + */
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c4" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c5" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c6" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c7" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c8" rowspan="1" colspan="1"></td>' +
                                /* '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c9" rowspan="1" colspan="1"></td>' + */
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c10" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c11" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c12" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c13" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c14" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c15" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c16" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c17" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c18" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c19" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c20" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c21" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c22" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c23" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c24" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c25" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c26" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c27" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c28" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c29" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c30" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c31" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c32" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c33" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c34" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c35" rowspan="1" colspan="1"></td>' +
                                // '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c36" rowspan="1" colspan="1"></td>' +
                                '<td id="tbody_r'+gs[i].areaId+'_'+cy[j].gasTypeId+'_c37" rowspan="1" colspan="1"></td>' +
                            '</tr>';
                        }
                    }
                }
                $("#tbody").html(tbody);
            }
        });        

        //查询按钮时间
        $("#find_sign").click(function() {
            if ($("#find_date").val() == "") {
                bootbox.alert("请您选择要查询的月份！");
                return;
            }
            $("#title").html($("#find_date").val()+"&nbsp;&nbsp;IC卡统计");
            var userInfo = JSON.parse(localStorage.getItem("user_info"));
            if(userInfo.employee_name){
                $("#foot_r0_c8").html(userInfo.employee_name);
            }else{
                $("#foot_r0_c8").html("管理员");
            }
            $("#foot_r0_c37").html(date_format(new Date(),"yyyy-MM-dd"));

            $("#btn_down_detail").removeClass("disabled");
            $("#btn_down_detail").removeClass("gray");
            $("#btn_down_detail").addClass("green");

            $("#btn_print_page").removeClass("disabled");
            $("#btn_print_page").removeClass("gray");
            $("#btn_print_page").addClass("green");
            //报表时间是上月26日到当月26日
            var curMonth=$("#find_date").val().replace('年','-').replace('月','');   
            //月末         
            var end = dateHelper.getMonthEnd(curMonth);
            //月初
            var start = dateHelper.getMonthStart(curMonth);
            //获取当年年初
            var startYear=dateHelper.getCurYearMonthStart(curMonth);
            //当年
            var year=dateHelper.getCurYear(curMonth);
            
            //当月
            var month=parseInt(dateHelper.getCurMonth(curMonth));
            //上年上月 {prevmonth:"",prevyear:""};考虑跨年
            var prev=dateHelper.getPrevMonth(curMonth);
            //上年
            var prevyear=dateHelper.getPrevYear(curMonth);

            //本月暂停和拆除条件
            var whereCause1= " completeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            //本年暂停和拆除条件
            var startYear=moment(start).format('YYYY')+'-1-1',endYear=moment(end).add('year',1).format('YYYY')+'-1-1';
            var whereCause2=" completeDate between to_date('" + startYear + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
           
            
            var whereCause29= " customerType='I' and tradeTypeDesc='BLLCORRECT' and tradeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            
            var whereCause30=" customerType='I' and tradeTypeDesc='BLLCORRECT' and tradeDate between to_date('" + startYear + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            var whereCause31= " customerType='I' and tradeTypeDesc='BLLCORRECT' and tradeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            var whereCause32=" customerType='I' and tradeTypeDesc='BLLCORRECT' and tradeDate between to_date('" + startYear + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            
            var whereCause36= " customerType='I' and tradeTypeDesc='ICTRANSMONEY' and tradeDate between to_date('" + startYear + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            //获取累积总数 已改完
            var whereClause3_4_5 = " customerType='I' and reportYear='"+year+"' and reportMonth="+month;
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(normalNum) normalNum,sum(noUseNum) noUseNum,sum(dismantleNum) dismantleNum,\
                    sum(stopNum) stopNum,sum(longUseNum) longUseNum,areaId,gasTypeId",
                    froms: "vmGasReportArchive",
                    wheres: whereClause3_4_5+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var longuseNumTotal=0,guanliNumTotal=0,yikaishuanNumTotal=0,normalNumTotal=0,stopNumTotal=0,dismantleNumTotal=0,nouseNumTotal=0;
                    
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var result=getReportArchiveNum(data.rows,areaId,gasTypeId) ;

                        //小计
                        if(gasTypeId=="-1"){
                            // $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c3").html(toZero(guanliNumTotal));       
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c4").html(toZero(longuseNumTotal));      
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c5").html(toZero(yikaishuanNumTotal));      
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c6").html(toZero(normalNumTotal));      
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c7").html(toZero(stopNumTotal));     
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c8").html(toZero(dismantleNumTotal));     
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c9").html(toZero(nouseNumTotal));
                            longuseNumTotal=0,guanliNumTotal=0,yikaishuangNumTotal=0,normalNumTotal=0,stopNumTotal=0,dismantleNumTotal=0,nouseNumTotal=0;
                        }else{

                            //管理数=未开栓+正常+暂停数+长期不用
                            var guanliNum=result.nouseNum+result.normalNum+result.stopNum+result.longuseNum;
                            //已开栓=正常数+暂停数
                            var yikaishuanNum=result.normalNum+result.stopNum;
                            
                            longuseNumTotal+=result.longuseNum ;
                            guanliNumTotal+=guanliNum;
                            yikaishuanNumTotal+=yikaishuanNum;
                            normalNumTotal+=result.normalNum;
                            stopNumTotal+=result.stopNum;
                            dismantleNumTotal+=result.dismantleNum;
                            nouseNumTotal+=result.nouseNum;   
                            // $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c3").html(toZero(guanliNum));       
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c4").html(toZero(result.longuseNum));      
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c5").html(toZero(yikaishuanNum));      
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c6").html(toZero(result.normalNum));      
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c7").html(toZero(result.stopNum));     
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c8").html(toZero(result.dismantleNum));     
                            // $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c9").html(toZero(result.nouseNum));
                        }
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var longuseNumTotal=0,guanliNumTotal=0,yikaishuanNumTotal=0,normalNumTotal=0,stopNumTotal=0,dismantleNumTotal=0,nouseNumTotal=0;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c4']").each(function(i){                                
                            if(i>0)longuseNumTotal+=parseInt($(this).text());
                        });
                        // $("#tbody").find("td[id$='"+gasTypeId+"_c3']").each(function(i){                                
                        //     if(i>0)guanliNumTotal+=parseInt($(this).text());
                        // });
                        $("#tbody").find("td[id$='"+gasTypeId+"_c5']").each(function(i){                                
                            if(i>0)yikaishuanNumTotal+=parseInt($(this).text());
                        });
                        $("#tbody").find("td[id$='"+gasTypeId+"_c6']").each(function(i){                                
                            if(i>0)normalNumTotal+=parseInt($(this).text());
                        });
                        $("#tbody").find("td[id$='"+gasTypeId+"_c7']").each(function(i){                                
                            if(i>0)stopNumTotal+=parseInt($(this).text());
                        });
                        $("#tbody").find("td[id$='"+gasTypeId+"_c8']").each(function(i){                                
                            if(i>0)dismantleNumTotal+=parseInt($(this).text());
                        });
                        // $("#tbody").find("td[id$='"+gasTypeId+"_c9']").each(function(i){                                
                        //     if(i>0)nouseNumTotal+=parseInt($(this).text());
                        // });
                        // $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c3").html(toZero(guanliNumTotal)); 
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c4").html(toZero(longuseNumTotal)); 
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c5").html(toZero(yikaishuanNumTotal)); 
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c6").html(toZero(normalNumTotal)); 
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c7").html(toZero(stopNumTotal)); 
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c8").html(toZero(dismantleNumTotal)); 
                        // $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c9").html(toZero(nouseNumTotal));  
                    })
                }
            });
            //本月新增IC卡条件
            var whereCause3=" completeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";;  
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "aa.areaId,aa.gasTypeId,count(1) ctmNum",
                    froms: "(select distinct customerCode,areaId,gasTypeId from vmReportIcNew where "+whereCause3+") aa",
                    wheres: "1=1 group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0;
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        //小计
                        if(gasTypeId=="-1"){ 
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c10").html(toZero(numTotal));
                            numTotal=0;
                        }else{
                            var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c10").html(toZero(num));
                        } 

                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var numTotal=0;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c10']").each(function(i){                                
                            if(i>0)numTotal+=parseInt($(this).text());
                        });
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c10").html(toZero(numTotal));  
                    })
                }
            });
            //获取本月暂停（表/客）户数和拆除（表/客）户数总数 已改完静态表
            var whereClause12_17=" customerType='I' and reportYear="+year+" and reportMonth="+month;
            var whereClause12_17_1=" customerType='I' and reportYear="+prev.year+" and reportMonth="+prev.month;            
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(stopNum) stopNum, sum(dismantleNum) dismantleNum,areaId,gasTypeId",
                    froms: "vmGasReportArchive",
                    wheres: whereClause12_17+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    console.log("data",data)
                    //获取上月
                    $.ajax({
                        url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                        type: "POST",
                        contentType: "application/json;charset=utf-8",
                        data: JSON.stringify({
                            cols: "sum(stopNum) stopNum, sum(dismantleNum) dismantleNum,areaId,gasTypeId",
                            froms: "vmGasReportArchive",
                            wheres: whereClause12_17_1+" group by areaId,gasTypeId",
                            page: "false"
                        }),
                        dataType: "json",
                        success: function (dataprev) {
                            console.log("dataprev",dataprev);
                            var stopNumTotal=0,dismantleNumTotal=0;

                            $("#tbody").find("tr").each(function(){
                                var areaId=$(this).data("areaid");
                                var gasTypeId=$(this).data("gastypeid"); 
                                var result=getReportArchiveNum(data.rows,areaId,gasTypeId) ;
                                var resultprev=getReportArchiveNum(dataprev.rows,areaId,gasTypeId) ;
                                
                                //小计
                                if(gasTypeId=="-1"){    
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c12").html(toZero(stopNumTotal));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c17").html(toZero(dismantleNumTotal));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c11").html(toZero(stopNumTotal));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c15").html(toZero(dismantleNumTotal));
                                    stopNumTotal=0,dismantleNumTotal=0;
                                }else{  
                                    var curStopNum=(result.stopNum-resultprev.stopNum)
                                    var curDismantleNum=(result.dismantleNum-resultprev.dismantleNum);
                                    stopNumTotal+=curStopNum;
                                    dismantleNumTotal+=curDismantleNum;
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c12").html(toZero(curStopNum));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c17").html(toZero(curDismantleNum));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c11").html(toZero(curStopNum));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c15").html(toZero(curDismantleNum));
                                } 
                            })
                            $("#tbody").find("[data-areaid='1']").each(function(){
                                var areaId=$(this).data("areaid");
                                var gasTypeId=$(this).data("gastypeid"); 
                                var num12Total=0,num17Total=0;
                                $("#tbody").find("td[id$='"+gasTypeId+"_c12']").each(function(i){                                
                                    if(i>0)num12Total+=parseInt($(this).text());
                                });
                                $("#tbody").find("td[id$='"+gasTypeId+"_c17']").each(function(i){                                
                                    if(i>0)num17Total+=parseInt($(this).text());
                                });
                                $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c12").html(toZero(num12Total));  
                                $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c17").html(toZero(num17Total)); 
                                $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c11").html(toZero(num12Total));  
                                $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c15").html(toZero(num17Total));  
                            })
                        }
                    });                    
                }
            });
            //获取本年暂停表户数和拆除表户数总数 已改完静态表
            var whereClause14_18="  customerType='I' and reportYear="+year+" and reportMonth="+month;
            var whereClause14_18_1="  customerType='I' and reportYear="+prevyear+" and reportMonth="+month;
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(stopNum) stopNum, sum(dismantleNum) dismantleNum,areaId,gasTypeId",
                    froms: "vmGasReportArchive",
                    wheres: whereClause14_18+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {

                    //获取上年的
                    $.ajax({
                        url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                        type: "POST",
                        contentType: "application/json;charset=utf-8",
                        data: JSON.stringify({
                            cols: "sum(stopNum) stopNum, sum(dismantleNum) dismantleNum,areaId,gasTypeId",
                            froms: "vmGasReportArchive",
                            wheres: whereClause14_18_1+" group by areaId,gasTypeId",
                            page: "false"
                        }),
                        dataType: "json",
                        success: function (dataprev) {
                            var stopNumTotal=0,dismantleNumTotal=0;
                            $("#tbody").find("tr").each(function(){
                                var areaId=$(this).data("areaid");
                                var gasTypeId=$(this).data("gastypeid"); 
                                var result=getReportArchiveNum(data.rows,areaId,gasTypeId) ;
                                var resultprev=getReportArchiveNum(dataprev.rows,areaId,gasTypeId) 
                                //小计
                                if(gasTypeId=="-1"){ 
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c14").html(toZero(stopNumTotal));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c18").html(toZero(dismantleNumTotal));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c13").html(toZero(stopNumTotal));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c16").html(toZero(dismantleNumTotal));
                                    stopNumTotal=0,dismantleNumTotal=0;
                                }else{
                                    var curStopNum=(result.stopNum-resultprev.stopNum);
                                    var curDismantleNum=(result.dismantleNum-resultprev.dismantleNum);
                                    stopNumTotal+=curStopNum;
                                    dismantleNumTotal+=curDismantleNum;
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c14").html(toZero(curStopNum));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c18").html(toZero(curDismantleNum));

                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c13").html(toZero(curStopNum));
                                    $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c16").html(toZero(curDismantleNum));
                                } 
                            })

                            $("#tbody").find("[data-areaid='1']").each(function(){
                                var areaId=$(this).data("areaid");
                                var gasTypeId=$(this).data("gastypeid"); 
                                var num14Total=0,num18Total=0;
                                $("#tbody").find("td[id$='"+gasTypeId+"_c14']").each(function(i){                                
                                    if(i>0)num14Total+=parseInt($(this).text());
                                });
                                $("#tbody").find("td[id$='"+gasTypeId+"_c18']").each(function(i){                                
                                    if(i>0)num18Total+=parseInt($(this).text());
                                });
                                $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c14").html(toZero(num14Total));  
                                $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c18").html(toZero(num18Total));  
                                $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c13").html(toZero(num14Total));
                                $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c16").html(toZero(num18Total));
                            })
                        }
                    });                    
                }
            });
            
            //获取抄表量
            var whereCause19= " copyTime between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(chargeMeterReading) ctmNum,areaId,gasTypeId",
                    froms: "vmReportIcMeterNum",
                    wheres: whereCause19+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c19").html(toZero(numTotal));
                        
                            numTotal=0;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c19").html(toZero(num));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num19Total=0;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c19']").each(function(i){                                
                            if(i>0)num19Total+=parseInt($(this).text());
                        });  
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c19").html(toZero(num19Total));  
                    })
                }
            });
            //获取累计抄表量
            var whereCause20=" copyTime between to_date('" + startYear + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(chargeMeterReading) ctmNum,areaId,gasTypeId",
                    froms: "vmReportIcMeterNum",
                    wheres: whereCause20+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c20").html(toZero(numTotal));
                            numTotal=0;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c20").html(toZero(num));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num20Total=0;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c20']").each(function(i){                                
                            if(i>0)num20Total+=parseInt($(this).text());
                        });  
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c20").html(toZero(num20Total));  
                    })
                }
            });
            //获取计费量 已改为静态表
            var whereCause21= " customerType='I' and tradeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(ysl) ctmNum,areaId,gasTypeId",
                    froms: "gasReportSse",
                    wheres: whereCause21+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c21").html(toZero(numTotal));
                            numTotal=0;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c21").html(toZero(num));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num21Total=0;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c21']").each(function(i){ 
                            if(i>0)num21Total+=parseInt($(this).text());     
                        });  
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c21").html(toZero(num21Total));  
                    })
                }
            });
            //获取累积计费量 已改为静态表
            var whereCause22=" customerType='I' and tradeDate between to_date('" + startYear + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(ysl) ctmNum,areaId,gasTypeId",
                    froms: "gasReportSse",
                    wheres: whereCause22+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c22").html(toZero(numTotal));
                            numTotal=0;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c22").html(toZero(num));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num22Total=0;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c22']").each(function(i){ 
                            if(i>0)num22Total+=parseInt($(this).text());     
                        });  
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c22").html(toZero(num22Total));  
                    })
                }
            });            
            //获取本月计费额 已改为静态表
            var whereCause23= " customerType='I' and tradeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";            
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(money) ctmNum,areaId,gasTypeId",
                    froms: "gasReportSse",
                    wheres: whereCause23+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0.00;
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c23").html(toZero(numTotal.toFixed(2)));
                            numTotal=0.00;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c23").html(toZero(num.toFixed(2)));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num23Total=0.00;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c23']").each(function(i){ 
                            if(i>0){                   
                                num23Total+=parseFloat($(this).text());
                            }         
                        });  
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c23").html(toZero(num23Total.toFixed(2)));  
                    })
                }
            });
            //获取累积计费额 已改为静态表
            var whereCause24=" customerType='I' and tradeDate between to_date('" + startYear + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(money) ctmNum,areaId,gasTypeId",
                    froms: "gasReportSse",
                    wheres: whereCause24+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0.00;
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c24").html(toZero(numTotal.toFixed(2)));
                            numTotal=0.00;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c24").html(toZero(num.toFixed(2)));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num24Total=0.00;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c24']").each(function(i){ 
                            if(i>0) num24Total+=parseFloat($(this).text());
                        });  
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c24").html(toZero(num24Total.toFixed(2)));  
                    })
                }
            });
            //获取追补量 已改为静态表
            var whereCause25= "customerType='I' and tradeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(recoverGas) ctmNum,areaId,gasTypeId",
                    froms: "gasReportYsl",
                    wheres: whereCause25+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0
                    console.log("获取追补量",data)
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c25").html(toZero(numTotal));
                            numTotal=0;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c25").html(toZero(num));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num25Total=0;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c25']").each(function(i){ 
                            console.log("areaid:",$(this).text());
                            if(i>0) num25Total+=parseInt($(this).text());
                        });  
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c25").html(toZero(num25Total));  
                    })
                }
            });
            //获取累积追补量 已改为静态表
            var whereCause26="customerType='I' and tradeDate between to_date('" + startYear + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(recoverGas) ctmNum,areaId,gasTypeId",
                    froms: "gasReportYsl",
                    wheres: whereCause26+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c26").html(toZero(numTotal));
                            numTotal=0;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c26").html(toZero(num));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num26Total=0;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c26']").each(function(i){ 
                            if(i>0) num26Total+=parseInt($(this).text());
                        });  
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c26").html(toZero(num26Total));  
                    })
                }
            });
            //获取追补额 已改为静态表
            var whereCause27= "customerType='I' and tradeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";           
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(recoverMoney) ctmNum,areaId,gasTypeId",
                    froms: "gasReportSse",
                    wheres: whereCause27+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0.00;
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c27").html(toZero(numTotal.toFixed(2)));
                            numTotal=0.00;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c27").html(toZero(num.toFixed(2)));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num27Total=0.00;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c27']").each(function(i){ 
                            num27Total+=parseFloat($(this).text());
                        });  
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c27").html(toZero(num27Total.toFixed(2)));  
                    })
                }
            });
            //获取累积追补额 已改为静态表
            var whereCause28=" customerType='I' and tradeDate between to_date('" + startYear + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";           
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(recoverMoney) ctmNum,areaId,gasTypeId",
                    froms: "gasReportSse",
                    wheres: whereCause28+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0.00;
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c28").html(toZero(numTotal.toFixed(2)));
                            numTotal=0.00;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c28").html(toZero(num.toFixed(2)));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num28Total=0.00;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c28']").each(function(i){ 
                            if(i>0) num28Total+=parseFloat($(this).text());
                        });  
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c28").html(toZero(num28Total.toFixed(2)));  
                    })
                }
            });          
            //获取抄表户 ***咨询是否包含计划抄表和业务抄表
            var whereCause34="  customerType='I' and reportYear="+year+" and reportMonth="+month;
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "areaId,gasTypeId,sum(copyNum+bizCopyNum+tempCopyNum) ctmNum",
                    froms: "gasReportMrd",
                    wheres: whereCause34+" group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0;
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        //小计
                        if(gasTypeId=="-1"){ 
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c34").html(toZero(numTotal));
                            numTotal=0;
                        }else{
                            var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c34").html(toZero(num));
                        } 

                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var numTotal=0;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c34']").each(function(i){                                
                            if(i>0)numTotal+=parseInt($(this).text());
                        }); 
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c34").html(toZero(numTotal));  
                    })
                }
            });
            
            //获取计费户
            var whereCause35= " customerType='I' and tradeType in ('ICB') and tradeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') \
                                and money<>0";
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "aa.areaId,aa.gasTypeId,count(1) ctmNum",
                    froms: "(select distinct customerCode,areaId,gasTypeId from gasActGasfeeAtl where "+whereCause35+") aa",
                    wheres: "1=1 group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0;
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        //小计
                        if(gasTypeId=="-1"){ 
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c35").html(toZero(numTotal));
                            numTotal=0;
                        }else{
                            var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c35").html(toZero(num));
                        } 

                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var numTotal=0;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c35']").each(function(i){                                
                            if(i>0)numTotal+=parseInt($(this).text());
                        }); 
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c35").html(toZero(numTotal));  
                    })
                }
            });
            //获取卡内余量 卡内余额/单价 要考虑大客户优惠
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(yuliang) ctmNum,areaId,gasTypeId",
                    froms: "vmReportIcKnyl",
                    wheres: "1=1 group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0.00;
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c37").html(toZero(numTotal.toFixed(2)));
                            numTotal=0.00;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c37").html(toZero(num.toFixed(2)));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var numTotal=0.00;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c37']").each(function(i){                                
                            if(i>0)numTotal+=parseInt($(this).text());
                        }); 
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c37").html(toZero(numTotal.toFixed(2)));  
                    })
                }
            });

            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "count(*) ctmNum,areaId,gasTypeId",
                    froms: "vmReportIcKnyl",
                    wheres: "yuliang=0 group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    var numTotal=0.00;
                    $("#tbody").find("tr").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var num=getArchiveIcNum(data.rows,areaId,gasTypeId) ;
                        //小计
                        if(gasTypeId=="-1"){    
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c38").html(toZero(numTotal.toFixed(2)));
                            numTotal=0.00;
                        }else{  
                            numTotal+=num;
                            $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c38").html(toZero(num.toFixed(2)));
                        } 
                    })
                    $("#tbody").find("[data-areaid='1']").each(function(){
                        var areaId=$(this).data("areaid");
                        var gasTypeId=$(this).data("gastypeid"); 
                        var numTotal=0.00;
                        $("#tbody").find("td[id$='"+gasTypeId+"_c38']").each(function(i){                                
                            if(i>0)numTotal+=parseInt($(this).text());
                        }); 
                        $(this).find("#tbody_r"+areaId+"_"+gasTypeId+"_c38").html(toZero(numTotal.toFixed(2)));  
                    })
                }
            });

        });
    });
</script><!-- End of User Script-->
</html>