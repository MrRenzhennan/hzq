<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]>
<html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="zh">
<!--<![endif]-->

<!-- BEGIN HEAD -->
<head>
    <title>非居民异地交费明细表</title>
    <script src="../pages/scripts/basepath.js"></script>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-select/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/select2/select2.css">
    <script src="../pages/scripts/header.js"></script>
    <meta http-equiv="content-type" content="text/html" charset="utf-8"/>
    <link href='../assets/global/plugins/jquery-watable/watable.css' rel='stylesheet'/>
    <link href='../assets/global/plugins/jquery-watable/animate.min.css' rel='stylesheet'/>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css"/>
    <link href='../assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css' rel='stylesheet'/>

    <!--datapicker css start-->
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-datepicker/css/datepicker3.css"/>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css"/>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-colorpicker/css/colorpicker.css"/>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css"/>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css"/>

    <link rel="stylesheet" href="statement/css/3.3.7/bootstrap.min.css">
    <style>
        @media print {
            .noneprint {
                display: none;
            }
        }

        .tabPrint td {
            border-left: #000000 solid 1px;
            border-top: #000000 solid 1px;
            height: 21px;
        }

        table.tabPrint {
            border-right: #000000 solid 1px;
            border-bottom: #000000 solid 1px;
        }

        .nextPage {
            page-break-after: always;
        }

        .linetd {
            border-bottom: solid 1px #000;
        }
    </style>
</head>
<!-- END HEAD -->

<body class="page-header-fixed page-quick-sidebar-over-content">

<!-- 标题栏开始 -->
<div class="page-header navbar navbar-fixed-top">
    <script>$.include("pages/partial/menu.shtml");</script>
</div>
<!-- 标题栏结束 -->
<div class="clearfix"></div>
<div class="page-container">
    <!-- 左侧菜单开始 -->
    <div class="page-sidebar-wrapper">
        <script>$.include("pages/partial/sidebar.shtml");</script>
    </div>
    <!-- 左侧菜单结束 -->

    <!-- 主内容开始 -->
    <div class="page-content-wrapper">
        <div class="page-content">
            <!--内容头开始-->
            <!--内容头开始-->
            <div class="row noneprint">
                <div class="col-md-12">
                    <ul class="page-breadcrumb breadcrumb">
                        <li>
                            <i class="fa fa-map-marker"></i>
                            <a href="index.html">报表统计</a>
                            <i class="fa fa-angle-right"></i>
                        </li>
                        <li>
                            <a href="javascript:void(0)">非居民异地交费明细表</a>
                        </li>
                    </ul>
                </div>
            </div>
            <!-- 内容头结束-->

            <!-- 内容开始-->

            <div class="container col-sm-12 noneprint" style="padding-bottom:0px">
                <div class="row">
                    <div class="col-sm-4 form-group">
                        <div class="btn-group input-group">
                            <div class="input-group-addon" style="border:0px;">日期：</div>
                            <div id="div_date" class="input-group input-large date-picker input-daterange" data-date="11/2012" data-date-format="yyyy年mm月">
                                <input id="find_date" type="text" class="form-control" name="from" width="50%">
                                <span class="inputclear glyphicon glyphicon-remove-circle hidden" ></span>
                            </div>
                        </div>
                    </div>
                    <div class="col-sm-3 form-group">
                        <div class="btn-group input-group">
                            <div class="input-group-addon" style="border:0px;">营业网点：</div>
                            <select id="find_chargeUnitId" class="form-control input-small select2me" data-placeholder="请选择营业网点">
                                <option value=""></option>
                            </select>
                            <span class="inputclear glyphicon glyphicon-remove-circle hide"></span>
                        </div>
                    </div>
                    <div class="col-sm-2 form-group">
                        <div class="btn-group input-group">
                            <div class="input-group-addon" style="border:0px;">营业员：</div>
                            <select id="find_employeeName" class="form-control input-small select2me" data-placeholder="请选择...">
                                <option value="">无</option>
                            </select>
                            <span class="inputclear glyphicon glyphicon-remove-circle hide"></span>
                        </div>
                    </div>
                    <div class="col-md-3">
                        <div class="form-group">
                            <button id="find_sign" type="button" class="btn yellow">
                                查询 <i class="fa fa-search"></i>
                            </button>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <button id="btn_print_page" onclick="window.print()" type="button" class="btn gray disabled" >
                                打印<i class="glyphicon"></i>
                            </button>
                            &nbsp;&nbsp;&nbsp;&nbsp;
                            <button id="btn_down_detail" type="button" class="btn gray disabled export-excel">
                                导出<i class="glyphicon"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            <!-- 内容头结束-->

            <div class="container-fluid">
                <div>
                    <table cellspacing="0" cellpadding="2" width="95%" align="center" border="0">
                        <tbody>
                        <tr>
                            <td id="title" align="center" title="">非居民异地交费明细表</td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <br>
                <div>
                    <table cellspacing="0" cellpadding="2" width="95%" align="center" border="0">
                        <tbody>
                        <tr>
                            <td id="head_r0_c1" rowspan="1" colspan="2" align="right" width="10%">收费网点：</td>
                            <td id="head_r0_c3" rowspan="1" colspan="1" width="70%" align="left"></td>
                            <td id="head_r0_c4" rowspan="1" colspan="1"></td>
                            <td id="head_r0_c5" rowspan="1" colspan="1"></td>
                            <td id="head_r0_c6" rowspan="1" colspan="1"></td>
                            <td id="head_r0_c7" rowspan="1" colspan="1" align="right" width="10%">填报日期：</td>
                            <td id="head_r0_c8" rowspan="1" colspan="1" align="left" width="20%"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <table class="tabPrint table-bordered table-hover table-condensed " align="center" width="95%" cellspacing="0" cellpadding="0" border="0"
                       id="table_" 0="">
                    <thead style="display:table-header-group;font-weight:bold"
                           mce_style="display:table-header-group;font-weight:bold">
                    <tr align="center">
                        <td id="thead_r1_c1" rowspan="1" colspan="1">序号</td>
                        <td id="thead_r1_c2" rowspan="1" colspan="1">用户所在单位</td>
                        <td id="thead_r1_c3" rowspan="1" colspan="1">用户号</td>
                        <td id="thead_r1_c4" rowspan="1" colspan="1">用户名</td>
                        <td id="thead_r1_c5" rowspan="1" colspan="1">收费金额</td>
                        <td id="thead_r1_c6" rowspan="1" colspan="1">收费方式</td>
                        <td id="thead_r1_c7" rowspan="1" colspan="1">是否IC卡用户</td>
                        <td id="thead_r1_c8" rowspan="1" colspan="1">备注</td>
                    </tr>
                    </thead>
                    <tbody>
                    <tr align="center">
                        <td id="tbody_r2_c1" rowspan="1" colspan="1">1</td>
                        <td id="tbody_r2_c2" rowspan="1" colspan="1"></td>
                        <td id="tbody_r2_c3" rowspan="1" colspan="1"></td>
                        <td id="tbody_r2_c4" rowspan="1" colspan="1"></td>
                        <td id="tbody_r2_c5" rowspan="1" colspan="1"></td>
                        <td id="tbody_r2_c6" rowspan="1" colspan="1"></td>
                        <td id="tbody_r2_c7" rowspan="1" colspan="1"></td>
                        <td id="tbody_r2_c8" rowspan="1" colspan="1"></td>
                    </tr>
                    <tr align="center">
                        <td id="tbody_r3_c1" rowspan="1" colspan="1">合计</td>
                        <td id="tbody_r3_c2" rowspan="1" colspan="1"></td>
                        <td id="tbody_r3_c3" rowspan="1" colspan="1"></td>
                        <td id="tbody_r3_c4" rowspan="1" colspan="1"></td>
                        <td id="tbody_r3_c5" rowspan="1" colspan="1"></td>
                        <td id="tbody_r3_c6" rowspan="1" colspan="1"></td>
                        <td id="tbody_r3_c7" rowspan="1" colspan="1"></td>
                        <td id="tbody_r3_c8" rowspan="1" colspan="1"></td>
                    </tr>
                    </tbody>
                </table>
                <br>
                <div>
                    <table cellspacing="0" cellpadding="2" width="95%" align="center" border="0">
                        <tbody>
                        <tr>
                            <td id="foot_r0_c1" rowspan="1" colspan="1" width="10%">营业制表人：</td>
                            <td id="foot_r0_c2" rowspan="1" colspan="1" width="15%"></td>
                            <td id="foot_r0_c3" rowspan="1" colspan="1"></td>
                            <td id="foot_r0_c4" rowspan="1" colspan="1"></td>
                            <td id="foot_r0_c5" rowspan="1" colspan="1"></td>
                            <td id="foot_r0_c6" rowspan="1" colspan="1"></td>
                            <td id="foot_r0_c7" rowspan="1" colspan="1" align="right" width="10%">财务复核人：</td>
                            <td id="foot_r0_c8" rowspan="1" colspan="1" align="left" width="15%"></td>
                        </tr>
                        </tbody>
                    </table>
                </div>
                <br><br>
            </div>
            <!-- 内容结束-->
        </div>
    </div>
    <!-- 主内容结束 -->
</div>

<!-- 底边栏开始 -->
<script>$.include("pages/partial/foot.shtml");</script>
<!-- 底边栏结束 -->
</body>



<script>$.include("pages/partial/scripts.shtml");</script>
<!--跳到原稿-->
<script src="../assets/global/plugins/jquery.cokie.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../assets/global/plugins/jquery-watable/jquery.watable.js"></script>
<script type="text/javascript" src="../pages/scripts/rqlbuilder.js"></script>
<script type="text/javascript" src="../pages/scripts/xwatable.js"></script>
<script type="text/javascript" src="../pages/scripts/refhelper.js"></script>

<!--datapicker start-->
<script type="text/javascript" src="../assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script type="text/javascript"
        src="../assets/global/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
<script type="text/javascript" src="../assets/global/plugins/clockface/js/clockface.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-daterangepicker/moment.min.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="../assets/admin/pages/scripts/components-pickers.js"></script>

<script type="text/javascript" src="../assets/global/plugins/select2/select2.js"></script>


<script src="statement/js/libs/js-xlsx/xlsx.core.min.js" type="text/javascript"></script>
<script src="statement/js/libs/html2canvas/html2canvas.min.js" type="text/javascript"></script>
<script src="statement/js/tableExport.js" type="text/javascript"></script>

<script type="text/javascript">

    $(".export-excel").attr("data-table",".tabPrint");
    //    $(".export-excel").attr("data-filename","");
    $(".export-excel").on("click", function (e) {
        e.preventDefault();
        var exportTable = $(this).data("table");
        var filename = $("#title").html();//$(this).data("filename");
        var ignoreColumn = "";//$(this).data("ignorecolumn");
        $(exportTable).tableExport({
            fileName: filename,
            type: 'excel',
            escape: 'false',
            excelstyles: ['border-bottom', 'border-top', 'border-left', 'border-right'],
            ignoreColumn: '[' + ignoreColumn + ']'
        });
    });

    $.fn.datetimepicker.dates['zh-CN'] = {
        days: ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六", "星期日"],
        daysShort: ["周日", "周一", "周二", "周三", "周四", "周五", "周六", "周日"],
        daysMin: ["日", "一", "二", "三", "四", "五", "六", "日"],
        months: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
        monthsShort: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
        today: "今天",
        suffix: [],
        meridiem: ["上午", "下午"]
    };
    jQuery(document).ready(function () {
        ComponentsPickers.init();
        // ComponentsDropdowns.init();
    });

    document.onkeydown = function () {keydown();};
    function keydown() {
        //P 空格 会车 event.keyCode==80 || event.keyCode==32 || event.keyCode==13
        if (event.keyCode == 13) {
            window.print();
        }
    }

    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null)return decodeURIComponent(r[2]);
        return null;
    }

    function toAmount(amount) {
        var numArray = amount.toString().split(".");

        if (numArray.length > 1) {
            console.log("##amount="+amount+"##"+amount.toString().split(".").length+"##"+numArray[1].length);
            if (numArray[1].length < 2) {
                amount = amount + "0";
            }else if (numArray[1].length > 2) {
                amount = numArray[0] + "." + numArray[1].substring(0, 2);
            }
        } else {
            amount = amount + ".00";
        }
        //return (amount * 1);//字符串变数字
        return amount;
    }

    function date_format(date, fmt) {
        var dataJson = {
            "M+": date.getMonth() + 1, //月份
            "d+": date.getDate(), //日
            "h+": date.getHours(), //小时
            "m+": date.getMinutes(), //分
            "s+": date.getSeconds(), //秒
            "q+": Math.floor((date.getMonth() + 3) / 3), //季度
            "S": date.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (date.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in dataJson)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (dataJson[k]) : (("00" + dataJson[k]).substr(("" + dataJson[k]).length)));
        return fmt;
    }

    function edit(id) {
        var v = $("#"+id).html();
        $("#"+id).html("<input type='number' id='"+id+"_text' oldid='"+id+"' oldvalue='"+v+"' value='"+v+"' onblur='outEdit(this.id)'/>");
        $("#"+id+"_text").focus();
    }
    function outEdit(id) {
        var ov = $("#"+id).attr("oldvalue");
        var oid = $("#"+id).attr("oldid");
        $("#"+oid).html($("#"+id).val());
    }

    function operationData(operationDataJson) {
        for (var i = 0; i < operationDataJson.length; i++) {
            var inputCols = operationDataJson[i].ic;
            var operator = operationDataJson[i].op;
            var out = $("#tbody_" + inputCols[0]).html() * 1;
            for (var j = 1; j < inputCols.length; j++) {
                var value = $("#tbody_" + inputCols[j]).html() * 1;
                if (operator == "+") {
                    out = out + value;
                }
            }
            var outputColType = operationDataJson[i].ty;
            var outputCol = operationDataJson[i].oc;
            if (outputColType && outputColType == "f") {
                $("#tbody_" + outputCol).html(toAmount(out + ""));
            } else {
                $("#tbody_" + outputCol).html(out);
            }

        }
    }



    var userInfo = JSON.parse(localStorage.getItem("user_info"));
    var isNotYYY = true;
    if(userInfo.station_id && (userInfo.station_id == "4" || userInfo.station_id == "5")){
        isNotYYY = false;
        var opts = '';
        if(userInfo.station_id == "4"){
            $("#find_employeeName").html('<option selected="selected" value="'+userInfo.userId+'">班长-'+userInfo.employee_name+'</option>');
            $("#find_employeeName").val(userInfo.userId).trigger('change');
        }else{
            $("#find_employeeName").html('<option selected="selected" value="'+userInfo.userId+'">营业员-'+userInfo.employee_name+'</option>');
            $("#find_employeeName").val(userInfo.userId).trigger('change');
        }
        $("#find_employeeName").attr("disabled",true);
        $.ajax({
            type: 'get',
            url: '/hzq_rest/gasbizchargeunit?query={"chargeUnitId":"'+userInfo.charge_unit_id+'"}', //?page=true&limit=10&skip=0
            dataType: 'json',
            contentType: "application/json; charset=utf-8",
            async: false,
            success: function(data, textStatus, xhr) {
                if(xhr.status == 200){
                    console.log(JSON.stringify(data));
                    var rows = data;
                    var opts = "";
                    for(var i =0; i < rows.length; i++){
                        opts += '<option selected="selected"  value="'+rows[i].chargeUnitId+'">'+rows[i].chargeUnitName+'</option>';
                        $("#find_chargeUnitId").html(opts);
                        $("#find_employeeName").val(rows[i].chargeUnitId).trigger('change');
                    }
                    $("#find_chargeUnitId").attr("disabled",true);
                } else if(xhr.status == 403){

                }
            },
            error: function(err) {
                if(err.status == 403){

                }
            }
        });
    }

    $("#find_date").val(date_format(new Date(),"yyyy年MM月"));
    $("#title").html($("#find_date").val()+"&nbsp;&nbsp;非居民异地交费明细表");


    $("#find_start_date").val(date_format(new Date(),"yyyy年MM月dd日"));
    $("#find_end_date").val(date_format(new Date(),"yyyy年MM月dd日"));
    $("#report_title").html("日收费统计");
    $("#find_date_sign_id").html("find_today_sign");
    $("#find_today_sign").removeClass("grayness");
    $("#find_today_sign").addClass("blue");
    $("#find_month_sign").removeClass("blue");
    $("#find_month_sign").addClass("grayness");
    $("#find_this_week_sign").removeClass("blue");
    $("#find_this_week_sign").addClass("grayness");
    $("#find_this_month_sign").removeClass("blue");
    $("#find_this_month_sign").addClass("grayness");
    $("#find_three_month_sign").removeClass("blue");
    $("#find_three_month_sign").addClass("grayness");
    $("#find_this_year_sign").removeClass("blue");
    $("#find_this_year_sign").addClass("grayness");
    $("#find_anyway_sign").removeClass("blue");
    $("#find_anyway_sign").addClass("grayness");

    //console.log("/hzq_rest/gasbizchargeunit?query="+RQLBuilder.like("chargeUnitName","%营%").rql());
    if(isNotYYY == true) {
        $.ajax({
            type: 'get',
            //url: "/hzq_rest/gasbizchargeunit?query="+RQLBuilder.like("chargeUnitName","%营%").rql(), //?page=true&limit=10&skip=0
            url: "/hzq_rest/gasbizchargeunit",
            dataType: 'json',
            contentType: "application/json; charset=utf-8",
            async: false,
            success: function (data, textStatus, xhr) {
                if (xhr.status == 200) {
                    console.log(JSON.stringify(data));
                    var opts = '<option value=""></option>';
                    var rows = data;
                    for (var i = 0; i < rows.length; i++) {
                        opts += '<option value="' + rows[i].chargeUnitId + '">' + rows[i].chargeUnitName + '</option>';
                    }
                    $("#find_chargeUnitId").html(opts);
                } else if (xhr.status == 403) {

                }
            },
            error: function (err) {
                if (err.status == 403) {

                }
            }
        });
    }
    $("#find_chargeUnitId").change(function(){
        if($("#find_chargeUnitId").val() == ""){
            var opts = '<option value="" >无</option>';
            $("#find_employeeName").html(opts);
            $("#find_employeeName").select2("val", "");
            $("#find_employeeName").select2("open");
            return;
        }
        var f_u_s = RQLBuilder.and([
            RQLBuilder.equal("chargeUnitId",$("#find_chargeUnitId").val())
            ,RQLBuilder.or([
                RQLBuilder.equal("stationId","5")
                ,RQLBuilder.equal("stationId","4")
            ])
        ]);
        $.ajax({
            type: 'get',
            url: '/hzq_rest/gassysuser?query='+f_u_s.rql(), //?page=true&limit=10&skip=0
            dataType: 'json',
            contentType: "application/json; charset=utf-8",
            async: false,
            success: function(data, textStatus, xhr) {
                if(xhr.status == 200){
                    console.log(JSON.stringify(data));
                    var opts = '';
                    var rows = data;
                    if(!rows.length || rows.length == 0){
                        opts = '<option value="" >无</option>';
                    }else{
                        //opts = '<option selected="selected" value="all" >网点全部人员</option>';
                        for(var i =0; i < rows.length; i++){
                            if(rows[i].stationId == "4"){
                                opts += '<option value="'+rows[i].userId+'">班长-'+rows[i].employeeName+'</option>';
                            }else{
                                opts += '<option value="'+rows[i].userId+'">营业员-'+rows[i].employeeName+'</option>';
                            }

                        }
                    }
                    $("#find_employeeName").html(opts);
                    $("#find_employeeName").select2("open");
                } else if(xhr.status == 403){

                }
            },
            error: function(err) {
                if(err.status == 403){

                }
            }
        });
    });

    var find_chargeUnitId_val = "";
    var find_employeeName_val = "";
    var find_start_date_val = "";
    var find_end_date_val = "";
    var find_fee_type_val = "";

    var find_chargeUnitId_text = "";
    var find_employeeName_text = "";

    //查询按钮时间
    $("#find_sign").click(function(){
        if($("#find_chargeUnitId").val() == ""){
            bootbox.alert("请您选择要查询的营业网点！");
            return;
        }
        if($("#find_start_date").val() == ""){
            bootbox.alert("请您选择要查询的开始日期！");
            return;
        }
        if($("#find_end_date").val() == ""){
            bootbox.alert("请您选择要查询的结束日期！");
            return;
        }
        if($("#find_employeeName").val() == ""){
            bootbox.alert("请您选择要查询的营业人员！");
            return;
        }

        find_chargeUnitId_val = $("#find_chargeUnitId").val();
        find_employeeName_val = $("#find_employeeName").val();
        find_date_val = $("#find_date").val().replace(/年/g,"-").replace(/月/g,"-").replace(/日/g,"");
        find_fee_type_val = $("#find_fee_type").val();

        find_chargeUnitId_text = $('#find_chargeUnitId option:selected').html();
        find_employeeName_text = $('#find_employeeName option:selected').html();

        $("#title").html($("#find_date").val()+"&nbsp;&nbsp;非居民异地交费明细表");
        var userInfo = JSON.parse(localStorage.getItem("user_info"));
        if(userInfo.employee_name){
            $("#foot_r0_c2").html(userInfo.employee_name);
        }else{
            $("#foot_r0_c2").html("管理员");
        }
        $("#head_r0_c8").html(date_format(new Date(),"yyyy-MM-dd"));


//        var wheres = "chargeUnitId='" + find_chargeUnitId_val
//            + "' and (tradeDate >= to_date('" + find_date_val + " 00:00:00','yyyy-MM-dd hh24:mi:ss')" +
//            " and tradeDate <= to_date('" + find_date_val + " 23:59:59','yyyy-MM-dd hh24:mi:ss')) ";
//
//        var wheres = "(tradeDate >= to_date('" + find_date_val + " 00:00:00','yyyy-MM-dd hh24:mi:ss')" +
//            " and tradeDate <= to_date('" + find_date_val + " 23:59:59','yyyy-MM-dd hh24:mi:ss')) ";

//        if (find_employeeName_val != "") {
//            wheres += "and userId='" + find_employeeName_val + "' ";
//        }

        $("#employeeNameText").html(find_employeeName_text.split("-")[1]);
        if(userInfo.employee_name){
            $("#userNameText").html(userInfo.employee_name);
        }else{
            $("#userNameText").html("管理员");
        }

        $("#chargeUnitIdText").html(find_chargeUnitId_text);

        //$("#dataTime").html(date_format(new Date(),"yyyy年MM月dd日"));
        $("#dataTime").html(find_end_date_val);

        //console.log('/hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd&bd={"cols":"*","froms":"vwChgSettlementPrint","wheres":"' + wheres + '","page":false}');
        $.ajax({
            type: 'get',
            url: '', //?page=true&limit=10&skip=0
            dataType: 'json',
            contentType: "application/json; charset=utf-8",
            async: false,
            success: function (data, textStatus, xhr) {
                if (xhr.status == 200) {

                    console.log(JSON.stringify(data));
                    if (!data.rows) {
                        return;
                    }

                    // TODO

                    $("#btn_down_detail").removeClass("disabled");
                    $("#btn_down_detail").removeClass("gray");
                    $("#btn_down_detail").addClass("green");

                    $("#btn_print_page").removeClass("disabled");
                    $("#btn_print_page").removeClass("gray");
                    $("#btn_print_page").addClass("green");

                } else if (xhr.status == 403) {

                }
            },
            error: function (err) {
                if (err.status == 403) {

                }
            }
        });

    });
    $("#find_start_date").change(function(){
        if($("#find_start_date").val() == ""){
            $("#find_start_date").val(date_format(new Date(),"yyyy年MM月dd日"));
        }
        var btn_id = $("#find_date_sign_id").html();
        if(btn_id == "find_anyway_sign"){
            if($("#find_start_date").val() != "" && $("#find_start_date").val() == $("#find_end_date").val()){
                $("#report_title").val("日收费统计");
            }else{
                $("#report_title").html($("#find_start_date").val()+"~"+$("#find_end_date").val()+"收费统计");
            }
        }else if(btn_id == "find_today_sign"){
            $("#find_end_date").val($("#find_start_date").val());
        }else if(btn_id == "find_month_sign"){
            var start_date = new Date(Date.parse($("#find_start_date").val().replace(/年/g,"/").replace(/月/g,"/").replace(/日/g,"")));
            start_date.setMonth(start_date.getMonth()+1);
            //start_date.setDate(1);
            //start_date.setDate(start_date.getDate()-1);
            start_date.setDate(25);
            $("#find_end_date").val(date_format(start_date,"yyyy年MM月dd日"));
            //start_date.setDate(1);
            start_date.setMonth(start_date.getMonth()-1);
            start_date.setDate(26);
            $("#find_start_date").val(date_format(start_date,"yyyy年MM月dd日"));
        }else if(btn_id == "find_this_week_sign"){
            var start_date = new Date(Date.parse($("#find_start_date").val().replace(/年/g,"/").replace(/月/g,"/").replace(/日/g,"/")));
            start_date.setDate(start_date.getDate()+6);
            $("#find_end_date").val(date_format(start_date,"yyyy年MM月dd日"));
        }else if(btn_id == "find_this_month_sign"){
            var start_date = new Date(Date.parse($("#find_start_date").val().replace(/年/g,"/").replace(/月/g,"/").replace(/日/g,"/")));
            start_date.setMonth(start_date.getMonth()+1);
            start_date.setDate(start_date.getDate()-1);
            $("#find_end_date").val(date_format(start_date,"yyyy年MM月dd日"));
        }else if(btn_id == "find_three_month_sign"){
            var start_date = new Date(Date.parse($("#find_start_date").val().replace(/年/g,"/").replace(/月/g,"/").replace(/日/g,"/")));
            start_date.setMonth(start_date.getMonth()+3);
            start_date.setDate(start_date.getDate()-1);
            $("#find_end_date").val(date_format(start_date,"yyyy年MM月dd日"));
        }else if(btn_id == "find_this_year_sign"){
            var start_date = new Date(Date.parse($("#find_start_date").val().replace(/年/g,"/").replace(/月/g,"/").replace(/日/g,"/")));
            start_date.setMonth(start_date.getMonth()+12);
            start_date.setDate(start_date.getDate()-1);
            $("#find_end_date").val(date_format(start_date,"yyyy年MM月dd日"));
        }
    });

    $("#find_end_date").change(function(){
        if($("#find_end_date").val() == ""){
            $("#find_end_date").val(date_format(new Date(),"yyyy年MM月dd日"));
        }
        var btn_id = $("#find_date_sign_id").html();
        if(btn_id == "find_anyway_sign"){
            if($("#find_end_date").val() != "" && $("#find_start_date").val() == $("#find_end_date").val()){
                $("#report_title").val("日收费统计");
            }else{
                $("#report_title").html($("#find_start_date").val()+"~"+$("#find_end_date").val()+"收费统计");
            }
        }else if(btn_id == "find_today_sign"){
            $("#find_start_date").val($("#find_end_date").val());
        }else if(btn_id == "find_month_sign"){
            var end_date = new Date(Date.parse($("#find_end_date").val().replace(/年/g,"/").replace(/月/g,"/").replace(/日/g,"/")));
            //end_date.setDate(1);
            end_date.setMonth(end_date.getMonth()-1);
            end_date.setDate(25);
            $("#find_start_date").val(date_format(end_date,"yyyy年MM月dd日"));
            //end_date.setMonth(end_date.getMonth()+1);
            //end_date.setDate(1);
            //end_date.setDate(end_date.getDate()-1);
            end_date.setMonth(end_date.getMonth()+1);
            end_date.setDate(26);
            $("#find_end_date").val(date_format(end_date,"yyyy年MM月dd日"));
        }else if(btn_id == "find_this_week_sign"){
            var end_date = new Date(Date.parse($("#find_end_date").val().replace(/年/g,"/").replace(/月/g,"/").replace(/日/g,"/")));
            end_date.setDate(end_date.getDate()-6);
            $("#find_start_date").val(date_format(end_date,"yyyy年MM月dd日"));
        }else if(btn_id == "find_this_month_sign"){
            var end_date = new Date(Date.parse($("#find_end_date").val().replace(/年/g,"/").replace(/月/g,"/").replace(/日/g,"/")));
            end_date.setMonth(end_date.getMonth()-1);
            end_date.setDate(end_date.getDate()+1);
            $("#find_start_date").val(date_format(end_date,"yyyy年MM月dd日"));
        }else if(btn_id == "find_three_month_sign"){
            var end_date = new Date(Date.parse($("#find_end_date").val().replace(/年/g,"/").replace(/月/g,"/").replace(/日/g,"/")));
            end_date.setMonth(end_date.getMonth()-3);
            end_date.setDate(end_date.getDate()+1);
            $("#find_start_date").val(date_format(end_date,"yyyy年MM月dd日"));
        }else if(btn_id == "find_this_year_sign"){
            var end_date = new Date(Date.parse($("#find_end_date").val().replace(/年/g,"/").replace(/月/g,"/").replace(/日/g,"/")));
            end_date.setMonth(end_date.getMonth()-12);
            end_date.setDate(end_date.getDate()+1);
            $("#find_start_date").val(date_format(end_date,"yyyy年MM月dd日"));
        }
    });


</script><!-- End of User Script-->
</html>