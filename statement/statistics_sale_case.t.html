<!DOCTYPE html>
<!--[if IE 8]>
<html lang="en" class="ie8"> <![endif]-->
<!--[if IE 9]>
<html lang="en" class="ie9"> <![endif]-->
<!--[if !IE]><!-->
<html lang="zh">
<!--<![endif]-->

<!-- BEGIN HEAD -->

<head>
    <title>月销售情况统计</title>
    <script src="../pages/scripts/basepath.js"></script>
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-select/bootstrap-select.min.css">
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/select2/select2.css">
    <script src="../pages/scripts/header.js"></script>
    <meta http-equiv="content-type" content="text/html" charset="utf-8" />
    <link href='../assets/global/plugins/jquery-watable/watable.css' rel='stylesheet' />
    <link href='../assets/global/plugins/jquery-watable/animate.min.css' rel='stylesheet' />
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/datatables/plugins/bootstrap/dataTables.bootstrap.css"
    />
    <link href='../assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css' rel='stylesheet' />

    <!--datapicker css start-->
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-datepicker/css/datepicker3.css" />
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-timepicker/css/bootstrap-timepicker.min.css"
    />
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-colorpicker/css/colorpicker.css" />
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-daterangepicker/daterangepicker-bs3.css"
    />
    <link rel="stylesheet" type="text/css" href="../assets/global/plugins/bootstrap-datetimepicker/css/datetimepicker.css" />
    <!--datapicker end-->

    <link rel="stylesheet" href="statement/css/3.3.7/bootstrap.min.css">
    <!-- END THEME STYLES -->
    <style>
        @media print {
            .noneprint {
                display: none;
            }
        }

        .tabPrint td {
            border-left: #000000 solid 1px;
            border-top: #000000 solid 1px;
            height: 21px;
        }

        table.tabPrint {
            border-right: #000000 solid 1px;
            border-bottom: #000000 solid 1px;
        }

        .nextPage {
            page-break-after: always;
        }

        .linetd {
            border-bottom: solid 1px #000;
        }
    </style>
</head>
<!-- END HEAD -->

<body class="page-header-fixed page-quick-sidebar-over-content">

    <!-- 标题栏开始 -->
    <div class="page-header navbar navbar-fixed-top">
        <script>
            $.include("pages/partial/menu.shtml");
        </script>
    </div>
    <!-- 标题栏结束 -->
    <div class="clearfix"></div>
    <div class="page-container">
        <!-- 左侧菜单开始 -->
        <div class="page-sidebar-wrapper">
            <script>
                $.include("pages/partial/sidebar.shtml");
            </script>
        </div>
        <!-- 左侧菜单结束 -->

        <!-- 主内容开始 -->
        <div class="page-content-wrapper">
            <div class="page-content">
                <!--内容头开始-->
                <!--内容头开始-->
                <div class="row noneprint">
                    <div class="col-md-12">
                        <ul class="page-breadcrumb breadcrumb">
                            <li>
                                <i class="fa fa-map-marker"></i>
                                <a href="index.html">报表统计</a>
                                <i class="fa fa-angle-right"></i>
                            </li>
                            <li>
                                <a href="javascript:void(0)">月销售情况统计</a>
                            </li>
                        </ul>
                    </div>
                </div>
                <!-- 内容头结束-->

                <!-- 内容开始-->

                <div class="container col-sm-12 noneprint" style="padding-bottom:0px">
                    <div class="row">

                        <div class="col-sm-3 form-group">
                            <div class="btn-group input-group">
                                <div class="input-group-addon" style="border:0px;">日期：</div>
                                <div id="div_date" class="input-group input-large date-picker input-daterange" data-date="11/2012" data-date-format="yyyy-mm">
                                    <input id="find_date" type="text" class="form-control" name="from">
                                    <span class="inputclear glyphicon glyphicon-remove-circle hidden"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-sm-3 form-group">
                        </div>
                        <div class="col-sm-3 form-group">
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                <button id="find_sign" type="button" class="btn yellow">
                                查询 <i class="fa fa-search"></i>
                            </button> &nbsp;&nbsp;&nbsp;&nbsp;
                                <button id="btn_print_page" onclick="window.print()" type="button" class="btn gray disabled">
                                打印<i class="glyphicon"></i>
                            </button> &nbsp;&nbsp;&nbsp;&nbsp;
                                <button id="btn_down_detail" type="button" class="btn gray disabled export-excel">
                                导出<i class="glyphicon"></i>
                            </button>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- 内容头结束-->

                <div class="container-fluid">
                    <div>
                        <table cellSpacing="0" cellPadding="2" width="95%" align="center" border="0">
                            <tr>
                                <td id="title" align="center" title="">天然气销售情况统计报表</td>
                            </tr>
                        </table>
                    </div>
                    <br/>
                    <div>
                        <table cellSpacing="0" cellPadding="2" width="95%" align="center" border="0">
                            <tr>
                                <td id="head_r0_c1" rowspan="1" colspan="1" width="85%" align="left">制表单位：哈尔滨中庆燃气有限责任公司营业部</td>
                                <td id="head_r0_c2" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c3" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c4" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c5" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c6" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c7" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c8" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c9" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c10" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c11" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c12" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c13" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c14" rowspan="1" colspan="1"></td>
                                <td id="head_r0_c15" rowspan="1" colspan="1" width="20%" align="right">单位:立方米、元、户</td>
                            </tr>
                        </table>
                    </div>
                    <table class="tabPrint table-bordered table-hover table-condensed " align="center" width="95%" cellSpacing="0" cellPadding="0"
                        border="0" ID="Table2">
                        <thead style="display:table-header-group;font-weight:bold" mce_style="display:table-header-group;font-weight:bold">
                            <tr align="center">
                                <td id="thead_r1_c1" rowspan="3" colspan="1">单位</td>
                                <td id="thead_r1_c1" rowspan="3" colspan="1"></td>
                                <td id="thead_r1_c2" rowspan="3" colspan="1">报告期管理户数</td>
                                <td id="thead_r1_c3" rowspan="3" colspan="1">报告期收费户数</td>
                                <td id="thead_r1_c4" rowspan="3" colspan="1">应抄表户数</td>
                                <td id="thead_r1_c5" rowspan="3" colspan="1">实抄表户数</td>
                                <td id="thead_r1_c6" rowspan="1" colspan="4">应收</td>
                                <td id="thead_r1_c10" rowspan="1" colspan="4">实收</td>
                                <td id="thead_r1_c14" rowspan="3" colspan="1">累计欠气费</td>
                                <td id="thead_r1_c15" rowspan="3" colspan="1">累计欠滞纳金</td>
                            </tr>
                            <tr align="center">
                                <td id="thead_r2_c6" rowspan="1" colspan="2">销售量</td>
                                <td id="thead_r2_c8" rowspan="1" colspan="2">销售额</td>
                                <td id="thead_r2_c10" rowspan="1" colspan="2">销售量</td>
                                <td id="thead_r2_c12" rowspan="1" colspan="2">销售总额</td>
                            </tr>
                            <tr align="center">
                                <td id="thead_r3_c6" rowspan="1" colspan="1">本月</td>
                                <td id="thead_r3_c7" rowspan="1" colspan="1">累计</td>
                                <td id="thead_r3_c8" rowspan="1" colspan="1">本月</td>
                                <td id="thead_r3_c9" rowspan="1" colspan="1">累计</td>
                                <td id="thead_r3_c10" rowspan="1" colspan="1">本月</td>
                                <td id="thead_r3_c11" rowspan="1" colspan="1">累计</td>
                                <td id="thead_r3_c12" rowspan="1" colspan="1">本月</td>
                                <td id="thead_r3_c13" rowspan="1" colspan="1">累计</td>
                            </tr>
                        </thead>
                        <tbody id="tbody">
                        </tbody>
                    </table>
                    <br/>
                    <div>
                        <table cellSpacing="0" cellPadding="2" width="95%" align="center" border="0">
                            <tr>
                                <td id="foot_r0_c1" rowspan="1" colspan="1">负责人：</td>
                                <td id="foot_r0_c2" rowspan="1" colspan="1" width="35%"></td>
                                <td id="foot_r0_c3" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c4" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c5" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c6" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c7" rowspan="1" colspan="1">制表人：</td>
                                <td id="foot_r0_c8" rowspan="1" colspan="1" width="15%"></td>
                                <td id="foot_r0_c9" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c10" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c11" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c12" rowspan="1" colspan="1"></td>
                                <td id="foot_r0_c13" rowspan="1" colspan="1" width="20%"></td>
                                <td id="foot_r0_c14" rowspan="1" colspan="1">填报日期：</td>
                                <td id="foot_r0_c15" rowspan="1" colspan="1"></td>
                            </tr>
                        </table>
                    </div>
                    <br/><br/>
                    <br/><br/></div>
                <!-- 内容结束-->
            </div>
        </div>
        <!-- 主内容结束 -->
    </div>

    <!-- 底边栏开始 -->
    <script>
                $.include("pages/partial/foot.shtml");
    </script>
    <!-- 底边栏结束 -->
</body>


<script>
        $.include("pages/partial/scripts.shtml");

</script>
<!--跳到原稿-->
<script src="../assets/global/plugins/jquery.cokie.min.js" type="text/javascript"></script>
<script type="text/javascript" src="../assets/global/plugins/jquery-watable/jquery.watable.js"></script>
<script type="text/javascript" src="../pages/scripts/rqlbuilder.js"></script>
<script type="text/javascript" src="../pages/scripts/xwatable.js"></script>
<script type="text/javascript" src="../pages/scripts/refhelper.js"></script>

<!--datapicker start-->
<script type="text/javascript" src="../assets/global/plugins/bootstrap-datepicker/js/bootstrap-datepicker.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-timepicker/js/bootstrap-timepicker.min.js"></script>
<script type="text/javascript" src="../assets/global/plugins/clockface/js/clockface.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-daterangepicker/moment.min.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-daterangepicker/daterangepicker.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-colorpicker/js/bootstrap-colorpicker.js"></script>
<script type="text/javascript" src="../assets/global/plugins/bootstrap-datetimepicker/js/bootstrap-datetimepicker.min.js"></script>
<script src="../assets/admin/pages/scripts/components-pickers.js"></script>

<script type="text/javascript" src="../assets/global/plugins/select2/select2.js"></script>


<script src="statement/js/libs/js-xlsx/xlsx.core.min.js" type="text/javascript"></script>
<script src="statement/js/libs/html2canvas/html2canvas.min.js" type="text/javascript"></script>
<script src="statement/js/tableExport.js" type="text/javascript"></script>

<script type="text/javascript">
    $(".export-excel").attr("data-table", ".tabPrint");
    //    $(".export-excel").attr("data-filename","");
    $(".export-excel").on("click", function (e) {
        e.preventDefault();
        var exportTable = $(this).data("table");
        var filename = $("#title").html();//$(this).data("filename");
        var ignoreColumn = "";//$(this).data("ignorecolumn");
        $(exportTable).tableExport({
            fileName: filename,
            type: 'excel',
            escape: 'false',
            excelstyles: ['border-bottom', 'border-top', 'border-left', 'border-right'],
            ignoreColumn: '[' + ignoreColumn + ']'
        });
    });

    $.fn.datetimepicker.dates['zh-CN'] = {
        days: ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六", "星期日"],
        daysShort: ["周日", "周一", "周二", "周三", "周四", "周五", "周六", "周日"],
        daysMin: ["日", "一", "二", "三", "四", "五", "六", "日"],
        months: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
        monthsShort: ["一月", "二月", "三月", "四月", "五月", "六月", "七月", "八月", "九月", "十月", "十一月", "十二月"],
        today: "今天",
        suffix: [],
        meridiem: ["上午", "下午"]
    };
    jQuery(document).ready(function () {
        ComponentsPickers.init();
        // ComponentsDropdowns.init();
    });

    document.onkeydown = function () { keydown(); };
    function keydown() {
        //P 空格 会车 event.keyCode==80 || event.keyCode==32 || event.keyCode==13
        if (event.keyCode == 13) {
            window.print();
        }
    }

    function getQueryString(name) {
        var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)");
        var r = window.location.search.substr(1).match(reg);
        if (r != null) return decodeURIComponent(r[2]);
        return null;
    }

    function toAmount(amount) {
        var numArray = amount.toString().split(".");

        if (numArray.length > 1) {
            if (numArray[1].length < 2) {
                amount = amount + "0";
            } else if (numArray[1].length > 2) {
                amount = numArray[0] + "." + numArray[1].substring(0, 2);
            }
        } else {
            amount = amount + ".00";
        }
        //return (amount * 1);//字符串变数字
        return amount;
    }

    function date_format(date, fmt) {
        var dataJson = {
            "M+": date.getMonth() + 1, //月份
            "d+": date.getDate(), //日
            "h+": date.getHours(), //小时
            "m+": date.getMinutes(), //分
            "s+": date.getSeconds(), //秒
            "q+": Math.floor((date.getMonth() + 3) / 3), //季度
            "S": date.getMilliseconds() //毫秒
        };
        if (/(y+)/.test(fmt)) fmt = fmt.replace(RegExp.$1, (date.getFullYear() + "").substr(4 - RegExp.$1.length));
        for (var k in dataJson)
            if (new RegExp("(" + k + ")").test(fmt)) fmt = fmt.replace(RegExp.$1, (RegExp.$1.length == 1) ? (dataJson[k]) : (("00" + dataJson[k]).substr(("" + dataJson[k]).length)));
        return fmt;
    }

    function edit(id) {
        var v = $("#" + id).html();
        $("#" + id).html("<input type='number' id='" + id + "_text' oldid='" + id + "' oldvalue='" + v + "' value='" + v + "' onblur='outEdit(this.id)'/>");
        $("#" + id + "_text").focus();
    }
    function outEdit(id) {
        var ov = $("#" + id).attr("oldvalue");
        var oid = $("#" + id).attr("oldid");
        $("#" + oid).html($("#" + id).val());
    }

    function operationData(operationDataJson) {
        for (var i = 0; i < operationDataJson.length; i++) {
            var inputCols = operationDataJson[i].ic;
            var operator = operationDataJson[i].op;
            var out = $("#tbody_" + inputCols[0]).html() * 1;
            for (var j = 1; j < inputCols.length; j++) {
                var value = $("#tbody_" + inputCols[j]).html() * 1;
                if (operator == "+") {
                    out = out + value;
                }
            }
            var outputColType = operationDataJson[i].ty;
            var outputCol = operationDataJson[i].oc;
            if (outputColType && outputColType == "f") {
                $("#tbody_" + outputCol).html(toAmount(out + ""));
            } else {
                $("#tbody_" + outputCol).html(out);
            }

        }
    }

    $(function () {
        $("#find_date").val(date_format(new Date(), "yyyy-MM"));
        $("#title").html($("#find_date").val() + "&nbsp;&nbsp;天然气销售情况统计报表");

        var areas = new Array();
        var area_id = JSON.parse(localStorage.getItem("user_info")).area_id;
        areas.push(area_id);
        //查询areaId下级areaId
        var queryCondion = RQLBuilder.and([
            RQLBuilder.equal("status", "1"),
            RQLBuilder.equal("parentAreaId", area_id)
        ]).rql()
        $.ajax({
            headers: {
                'Accept': 'application/json',
                'Content-Type': 'application/json'
            },
            type: 'get',
            async: false,
            url: hzq_rest + "gasbizarea?query=" + queryCondion,
            success: function (data) {
                for (var i = 0; i < data.length; i++) {
                    areas.push(data[i].areaId);
                }
            }
        });
        var AreaHelper1 = RefHelper.create({
            ref_url: 'gasbizarea?query={"areaId":{"$in":' + JSON.stringify(areas) + '}}',
            ref_col: "areaId",
            ref_display: "areaName",
            "sort": "posCode"
        });
        var gs = AreaHelper1.getRawData();
        $.ajax({
            url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
            type: "POST",
            contentType: "application/json;charset=utf-8",
            data: JSON.stringify({
                cols: "gasTypeCode,gasTypeName",
                froms: "gasBizGasType",
                wheres: " posCode = 0 and length(gasTypeCode)=3 order by gasTypeCode",
                page: "false"
            }),
            dataType: "json",
            success: function (data) {
                var tbody = "";
                for (var i = 0; i < gs.length; i++) {
                    for (var j = 0; j < data.rows.length; j++) {
                        var rn = data.rows.length + 1;
                        // if(gs[i] != "中庆燃气公司" && gs[i] != "13.工商服营业分公司（一）" && gs[i] != "14.工商服营业分公司（二）"){
                        //     rn = '8';
                        // }
                        if (j == 0) {
                            tbody = tbody + '<tr align="center">' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '" rowspan="' + rn + '" colspan="1">' + gs[i].areaName + '</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d1" rowspan="1" colspan="1">' + data.rows[j].gasTypeName + '</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d2" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d2">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d3" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d3">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d4" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d4">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d5" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d5">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d6" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d6">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d7" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d7">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d8" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d8">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d9" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d9">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d10" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d10">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d11" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d11">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d12" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d12">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d13" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d13">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d14" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d14">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d15" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d15">0</td>' +
                                '</tr>';
                        } else {
                            tbody = tbody + '<tr align="center">' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d1" rowspan="1" colspan="1">' + data.rows[j].gasTypeName + '</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d2" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d2">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d3" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d3">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d4" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d4">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d5" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d5">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d6" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d6">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d7" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d7">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d8" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d8">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d9" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d9">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d10" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d10">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d11" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d11">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d12" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d12">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d13" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d13">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d14" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d14">0</td>' +
                                '<td id="tbody_r' + gs[i].areaId + '_c' + data.rows[j].gasTypeCode + '_d15" rowspan="1" colspan="1" ctype="1" csumtype="' + gs[i].areaId + '_d15">0</td>' +
                                '</tr>';
                        }
                    }
                    tbody = tbody + '<tr align="center" style="background-color: #efefef">' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d1" rowspan="1" colspan="1">小计</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d2" rowspan="1" colspan="1" ctype="1" csum="d2" csumtypeid="' + gs[i].areaId + '_d2">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d3" rowspan="1" colspan="1" ctype="1" csum="d3" csumtypeid="' + gs[i].areaId + '_d3">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d4" rowspan="1" colspan="1" ctype="1" csum="d4" csumtypeid="' + gs[i].areaId + '_d4">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d5" rowspan="1" colspan="1" ctype="1" csum="d5" csumtypeid="' + gs[i].areaId + '_d5">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d6" rowspan="1" colspan="1" ctype="1" csum="d6" csumtypeid="' + gs[i].areaId + '_d6">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d7" rowspan="1" colspan="1" ctype="1" csum="d7" csumtypeid="' + gs[i].areaId + '_d7">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d8" rowspan="1" colspan="1" ctype="1" csum="d8" csumtypeid="' + gs[i].areaId + '_d8">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d9" rowspan="1" colspan="1" ctype="1" csum="d9" csumtypeid="' + gs[i].areaId + '_d9">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d10" rowspan="1" colspan="1" ctype="1" csum="d10" csumtypeid="' + gs[i].areaId + '_d10">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d11" rowspan="1" colspan="1" ctype="1" csum="d11" csumtypeid="' + gs[i].areaId + '_d11">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d12" rowspan="1" colspan="1" ctype="1" csum="d12" csumtypeid="' + gs[i].areaId + '_d12">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d13" rowspan="1" colspan="1" ctype="1" csum="d13" csumtypeid="' + gs[i].areaId + '_d13">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d14" rowspan="1" colspan="1" ctype="1" csum="d14" csumtypeid="' + gs[i].areaId + '_d14">0</td>' +
                        '<td id="tbody_r' + gs[i].areaId + '_c_d15" rowspan="1" colspan="1" ctype="1" csum="d15" csumtypeid="' + gs[i].areaId + '_d15">0</td>' +
                        '</tr>';
                }
                $("#tbody").html(tbody);
            }
        });

        //查询按钮时间
        $("#find_sign").click(function () {
            if ($("#find_date").val() == "") {
                bootbox.alert("请您选择要查询的月份！");
                return;
            }
            $("#find_sign").attr("disabled", "disabled");
            $("#title").html($("#find_date").val() + "&nbsp;&nbsp;天然气销售情况统计报表");

            var userInfo = JSON.parse(localStorage.getItem("user_info"));
            if (userInfo.employee_name) {
                $("#foot_r0_c8").html(userInfo.employee_name);
            } else {
                $("#foot_r0_c8").html("管理员");
            }
            $("#foot_r0_c15").html(date_format(new Date(), "yyyy-MM-dd"));

            $("#btn_down_detail").removeClass("disabled");
            $("#btn_down_detail").removeClass("gray");
            $("#btn_down_detail").addClass("green");

            $("#btn_print_page").removeClass("disabled");
            $("#btn_print_page").removeClass("gray");
            $("#btn_print_page").addClass("green");

            var start = moment($("#find_date").val() + "-26").add('month', -1).format("YYYY-MM-DD");
            var yearStart = moment(moment().add('year', -1).format("YYYY") + "-12-26").format("YYYY-MM-DD");
            var end = $("#find_date").val() + "-26";
            var reportYear = moment($("#find_date").val() + "-26").format("YYYY");
            var reportMonth = moment($("#find_date").val() + "-26").format("MM");
            var $tbody = $("#tbody");
            $tbody.find("td[ctype=1]").html("0");
            var whereClause1 = "";
            var whereClause2 = "";
            var whereClause3 = "";
            var whereClause4 = "";
            var whereClause5 = "";
            var whereClause6 = "";

            whereClause1 += " gas <> 0 and ";
            whereClause1 += " tradeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";

            whereClause2 += " money <> 0 and ";
            whereClause2 += " tradeDate between to_date('" + start + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";

            whereClause3 += " reportYear='" + reportYear + "' and reportMonth='" + reportMonth + "' ";
            //whereClause4 += " a.tradeDate < to_date('" + end + "','yyyy-MM-dd') ";
            whereClause4 += " reportYear='" + reportYear + "' and reportMonth='" + reportMonth + "' ";

            whereClause5 += " gas <> 0 and ";
            whereClause5 += " tradeDate between to_date('" + yearStart + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";

            whereClause6 += " money <> 0 and ";
            whereClause6 += " tradeDate between to_date('" + yearStart + "','yyyy-MM-dd') and to_date('" + end + "','yyyy-MM-dd') ";

            // 报告期管理户数
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "a.gasTypeId, a.areaId, sum(normalNum)+sum(stopNum) + sum(longUseNum) + sum(noUseNum) c",
                    froms: "gasReportArchive a",
                    wheres: whereClause3 + " group by areaId,gasTypeId",
                    page: "false",
                    // limit:1
                }),
                dataType: "json",
                success: function (data) {
                    if (data.rows) {
                        var rows = data.rows;
                        for (var i = 0; i < rows.length; i++) {
                            var count = rows[i].c ? parseFloat(rows[i].c).toFixed(0) : 0;
                            if (rows[i].gasTypeId) {
                                if (rows[i].areaId == "1") {
                                }
                                var $cellCount = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d2");
                                if ($cellCount.length > 0) {
                                    // var cellCountVal = parseFloat($.unformatMoney($cellCount.html()));
                                    var cellCountVal = parseFloat($cellCount.html());
                                    if (isNaN(cellCountVal)) {
                                        cellCountVal = 0;
                                    } else {
                                        cellCountVal = cellCountVal.toFixed(0);
                                    }
                                    // $cellCount.html($.formatMoney(cellCountVal * 1 + count * 1, 0));
                                    $cellCount.html(cellCountVal * 1 + count * 1);

                                    // total
                                    var $cellTotalCount = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d2");
                                    if ($cellTotalCount.length > 0) {
                                        // var cellTotalCountVal = parseFloat($.unformatMoney($cellTotalCount.html()));
                                        var cellTotalCountVal = parseFloat($cellTotalCount.html());
                                        if (isNaN(cellTotalCountVal)) {
                                            cellTotalCountVal = 0;
                                        } else {
                                            cellTotalCountVal = cellTotalCountVal.toFixed(0);
                                        }
                                        // $cellTotalCount.html($.formatMoney(cellTotalCountVal * 1 + count * 1, 0));
                                        $cellTotalCount.html(cellTotalCountVal * 1 + count * 1);
                                    }
                                }
                            } else {
                            }
                        }

                        // 计算小计
                        $tbody.find("td[csum=d2]").html("0");
                        $tbody.find("td[csum=d2]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                                $(element).html($(e).html() * 1 + $(element).html() * 1);
                            });
                        });
                    }
                }
            });

            // 报告期收费户数
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "a.gasTypeId, a.areaId, sum(normalNum) + sum(longUseNum) c",
                    froms: "gasReportArchive a",
                    wheres: whereClause3 + " group by areaId,gasTypeId",
                    page: "false",
                    // limit:1
                }),
                dataType: "json",
                success: function (data) {
                    if (data.rows) {
                        var rows = data.rows;
                        for (var i = 0; i < rows.length; i++) {
                            var count = rows[i].c ? parseFloat(rows[i].c).toFixed(0) : 0;
                            if (rows[i].gasTypeId) {
                                var $cellCount = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d3");
                                if ($cellCount.length > 0) {
                                    // var cellCountVal = parseFloat($.unformatMoney($cellCount.html()));
                                    var cellCountVal = parseFloat($cellCount.html());

                                    if (isNaN(cellCountVal)) {
                                        cellCountVal = 0;
                                    } else {
                                        cellCountVal = cellCountVal.toFixed(0);
                                    }
                                    // $cellCount.html($.formatMoney(cellCountVal * 1 + count * 1, 0));
                                    $cellCount.html(cellCountVal * 1 + count * 1);

                                    var $cellTotalCount = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d3");
                                    if ($cellTotalCount.length > 0) {
                                        // var cellTotalCountVal = parseFloat($.unformatMoney($cellTotalCount.html()));
                                        var cellTotalCountVal = parseFloat($cellTotalCount.html());
                                        if (isNaN(cellTotalCountVal)) {
                                            cellTotalCountVal = 0;
                                        } else {
                                            cellTotalCountVal = cellTotalCountVal.toFixed(0);
                                        }
                                        // $cellTotalCount.html($.formatMoney(cellTotalCountVal * 1 + count * 1, 0));
                                        $cellTotalCount.html(cellTotalCountVal * 1 + count * 1);
                                    }
                                }
                            } else {
                            }
                        }

                        // 计算小计
                        $tbody.find("td[csum=d3]").html("0");
                        $tbody.find("td[csum=d3]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                                $(element).html($(e).html() * 1 + $(element).html() * 1);
                            });
                        });
                    }
                }
            });

            // 应抄表户数
            // 需要排除未开栓和拆除用户
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "gasTypeId, areaId, sum(planCopyNum) c",
                    froms: "gasReportMrd",
                    wheres: whereClause3 + " group by b.areaId,b.gasTypeId",
                    page: "false",
                    // limit:1
                }),
                dataType: "json",
                success: function (data) {
                    if (data.rows) {
                        var rows = data.rows;
                        for (var i = 0; i < rows.length; i++) {
                            var count = rows[i].c ? parseFloat(rows[i].c).toFixed(0) : 0;
                            if (rows[i].gasTypeId) {
                                var $cellCount = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d4");
                                if ($cellCount.length > 0) {
                                    // var cellCountVal = parseFloat($.unformatMoney($cellCount.html()));
                                    var cellCountVal = parseFloat($cellCount.html());
                                    if (isNaN(cellCountVal)) {
                                        cellCountVal = 0;
                                    } else {
                                        cellCountVal = cellCountVal.toFixed(0);
                                    }
                                    // $cellCount.html($.formatMoney(cellCountVal * 1 + count * 1, 0));
                                    $cellCount.html(cellCountVal * 1 + count * 1);

                                    var $cellTotalCount = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d4");
                                    if ($cellTotalCount.length > 0) {
                                        // var cellTotalCountVal = parseFloat($.unformatMoney($cellTotalCount.html()));
                                        var cellTotalCountVal = parseFloat($cellTotalCount.html());
                                        if (isNaN(cellTotalCountVal)) {
                                            cellTotalCountVal = 0;
                                        } else {
                                            cellTotalCountVal = cellTotalCountVal.toFixed(0);
                                        }
                                        // $cellTotalCount.html($.formatMoney(cellTotalCountVal * 1 + count * 1, 0));
                                        $cellTotalCount.html(cellTotalCountVal * 1 + count * 1);
                                    }
                                }
                            } else {
                            }
                        }

                        // 计算小计
                        $tbody.find("td[csum=d4]").html("0");
                        $tbody.find("td[csum=d4]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                                $(element).html($(e).html() * 1 + $(element).html() * 1);
                            });
                        });
                    }
                }
            });

            // 实抄表户数
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "gasTypeId, areaId, sum(copyNum) c",
                    froms: "gasReportMrd",
                    wheres: whereClause3 + " group by b.areaId,b.gasTypeId",
                    page: "false",
                    // limit:1
                }),
                dataType: "json",
                success: function (data) {
                    if (data.rows) {
                        var rows = data.rows;
                        for (var i = 0; i < rows.length; i++) {
                            var count = rows[i].c ? parseFloat(rows[i].c).toFixed(0) : 0;
                            if (rows[i].gasTypeId) {
                                var $cellCount = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d5");
                                if ($cellCount.length > 0) {
                                    // var cellCountVal = parseFloat($.unformatMoney($cellCount.html()));
                                    var cellCountVal = parseFloat($cellCount.html());
                                    if (isNaN(cellCountVal)) {
                                        cellCountVal = 0;
                                    } else {
                                        cellCountVal = cellCountVal.toFixed(0);
                                    }
                                    // $cellCount.html($.formatMoney(cellCountVal * 1 + count * 1, 0));
                                    $cellCount.html(cellCountVal * 1 + count * 1);

                                    var $cellTotalCount = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d5");
                                    if ($cellTotalCount.length > 0) {
                                        // var cellTotalCountVal = parseFloat($.unformatMoney($cellTotalCount.html()));
                                        var cellTotalCountVal = parseFloat($cellTotalCount.html());
                                        if (isNaN(cellTotalCountVal)) {
                                            cellTotalCountVal = 0;
                                        } else {
                                            cellTotalCountVal = cellTotalCountVal.toFixed(0);
                                        }
                                        // $cellTotalCount.html($.formatMoney(cellTotalCountVal * 1 + count * 1, 0));
                                        $cellTotalCount.html(cellTotalCountVal * 1 + count * 1);
                                    }
                                }
                            } else {
                            }
                        }

                        // 计算小计
                        $tbody.find("td[csum=d5]").html("0");
                        $tbody.find("td[csum=d5]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                                $(element).html($(e).html() * 1 + $(element).html() * 1);
                            });
                        });
                    }
                }
            });

            // 取应收
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(gas) gas,sum(sse) sse,areaId,gasTypeId",
                    froms: "gasReportYsl",
                    wheres: whereClause1 + " group by areaId,gasTypeId",
                    page: "false"
                }),
                dataType: "json",
                success: function (data) {
                    if (data.rows) {
                        var rows = data.rows;
                        for (var i = 0; i < rows.length; i++) {
                            console.log(rows[i]);
                            var gas = rows[i].gas ? parseFloat(rows[i].gas).toFixed(4) : 0.0000;
                            var sse = rows[i].sse ? parseFloat(rows[i].sse).toFixed(4) : 0.0000;

                            if (rows[i].areaId == "23") {
                                var $cellGas = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d6");
                                // var cellGasVal = parseFloat($.unformatMoney($cellGas.html()));
                                var cellGasVal = parseFloat($cellGas.html());
                                if (isNaN(cellGasVal)) {
                                    cellGasVal = 0;
                                } else {
                                    cellGasVal = cellGasVal.toFixed(0);
                                }
                                // $cellGas.html($.formatMoney(cellGasVal * 1 + gas * 1, 1));
                                $cellGas.html(cellGasVal * 1 + gas * 1);

                                var $cellGas = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d10");
                                //var cellGasVal = parseFloat($.unformatMoney($cellGas.html()));
                                var cellGasVal = parseFloat($cellGas.html());
                                if (isNaN(cellGasVal)) {
                                    cellGasVal = 0;
                                } else {
                                    cellGasVal = cellGasVal.toFixed(0);
                                }
                                //$cellGas.html($.formatMoney(parseFloat(cellGasVal * 1 + money / price).toFixed(0), 0));
                                $cellGas.html(cellGasVal * 1 + gas * 1);

                                // total
                                var $cellTotalGas = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d6");
                                if ($cellTotalGas.length > 0) {
                                    // var cellTotalGasVal = parseFloat($.unformatMoney($cellTotalGas.html()));
                                    var cellTotalGasVal = parseFloat($cellTotalGas.html());
                                    if (isNaN(cellTotalGasVal)) {
                                        cellTotalGasVal = 0;
                                    } else {
                                        cellTotalGasVal = cellTotalGasVal.toFixed(0);
                                    }
                                    // $cellTotalGas.html($.formatMoney(cellTotalGasVal * 1 + gas * 1, 1));
                                    $cellTotalGas.html(cellTotalGasVal * 1 + gas * 1);

                                    var $cellTotalGas = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d10");
                                    if ($cellTotalGas.length > 0) {
                                        // var cellTotalGasVal = parseFloat($.unformatMoney($cellTotalMoney.html()));
                                        var cellTotalGasVal = parseFloat($cellTotalGas.html());
                                        if (isNaN(cellTotalGasVal)) {
                                            cellTotalGasVal = 0;
                                        } else {
                                            cellTotalGasVal = cellTotalGasVal.toFixed(0);
                                        }
                                        // $cellTotalGas.html($.formatMoney(cellTotalGasVal * 1 + gas * 1, 1));
                                        $cellTotalGas.html(cellTotalGasVal * 1 + gas * 1);
                                    }
                                }
                            } else {
                                var $cellGas = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d6");
                                // var cellGasVal = parseFloat($.unformatMoney($cellGas.html()));
                                var cellGasVal = parseFloat($cellGas.html());
                                if (isNaN(cellGasVal)) {
                                    cellGasVal = 0;
                                } else {
                                    cellGasVal = cellGasVal.toFixed(0);
                                }
                                // $cellGas.html($.formatMoney(cellGasVal * 1 + gas * 1, 1));
                                $cellGas.html(cellGasVal * 1 + gas * 1);

                                var $cellMoney = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d8");
                                // var cellMoneyVal = parseFloat($.unformatMoney($cellMoney.html()));
                                var cellMoneyVal = parseFloat($cellMoney.html());

                                if (isNaN(cellMoneyVal)) {
                                    cellMoneyVal = 0.0000;
                                } else {
                                    cellMoneyVal = cellMoneyVal.toFixed(4);
                                }
                                // $cellMoney.html($.formatMoney(cellMoneyVal * 1 + gas * 1 * price, 2));
                                $cellMoney.html(parseFloat(cellMoneyVal * 1 + sse * 1).toFixed(2));

                                // total
                                var $cellTotalGas = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d6");
                                if ($cellTotalGas.length > 0) {
                                    var cellTotalGasVal = parseFloat($cellTotalGas.html());
                                    if (isNaN(cellTotalGasVal)) {
                                        cellTotalGasVal = 0;
                                    } else {
                                        cellTotalGasVal = cellTotalGasVal.toFixed(0);
                                    }
                                    $cellTotalGas.html(cellTotalGasVal * 1 + gas * 1);

                                    var $cellTotalMoney = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d8");
                                    if ($cellTotalMoney.length > 0) {
                                        var cellTotalMoneyVal = parseFloat($cellTotalMoney.html());
                                        if (isNaN(cellTotalMoneyVal)) {
                                            cellTotalMoneyVal = 0.0000;
                                        } else {
                                            cellTotalMoneyVal = cellTotalMoneyVal.toFixed(4);
                                        }
                                        $cellTotalMoney.html(parseFloat(cellTotalMoneyVal * 1 + sse * 1).toFixed(2));
                                    }
                                }
                            }
                        }
                    }
                    // 计算小计
                    $tbody.find("td[csum=d6]").html("0");
                    $tbody.find("td[csum=d6]").each(function (index, element) {
                        $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                            // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                            $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(0));
                        });
                    });

                    // 计算小计
                    $tbody.find("td[csum=d8]").html("0");
                    $tbody.find("td[csum=d8]").each(function (index, element) {
                        $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                            // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 2));
                            $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(2));
                        });
                    });

                    // 计算小计
                    $tbody.find("td[csum=d10]").html("0");
                    $tbody.find("td[csum=d10]").each(function (index, element) {
                        $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                            // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 2));
                            $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(0));
                        });
                    });
                }
            });

            // 取应收累计
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(gas) gas,sum(sse) sse,areaId,gasTypeId",
                    froms: "gasReportYsl",
                    wheres: whereClause5 + " group by areaId,gasTypeId",
                    page: "false",
                    // limit:1
                }),
                dataType: "json",
                success: function (data) {
                    if (data.rows) {
                        var rows = data.rows;
                        for (var i = 0; i < rows.length; i++) {
                            var gas = rows[i].gas ? parseFloat(rows[i].gas).toFixed(4) : 0.0000;
                            var sse = rows[i].sse ? parseFloat(rows[i].sse).toFixed(4) : 0.0000;

                            if (rows[i].areaId == "23") {
                                var $cellGas = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d7");
                                // var cellGasVal = parseFloat($.unformatMoney($cellGas.html()));
                                var cellGasVal = parseFloat($cellGas.html());
                                if (isNaN(cellGasVal)) {
                                    cellGasVal = 0;
                                } else {
                                    cellGasVal = cellGasVal.toFixed(0);
                                }
                                //$cellGas.html($.formatMoney(cellGasVal * 1 + gas * 1, 0));
                                $cellGas.html(cellGasVal * 1 + gas * 1);
                                var $cellGas = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d11");
                                // var cellGasVal = parseFloat($.unformatMoney($cellGas.html()));
                                var cellGasVal = parseFloat($cellGas.html());
                                if (isNaN(cellGasVal)) {
                                    cellGasVal = 0;
                                } else {
                                    cellGasVal = cellGasVal.toFixed(0);
                                }
                                //$cellGas.html($.formatMoney(cellGasVal * 1 + gas * 1, 0));
                                $cellGas.html(cellGasVal * 1 + gas * 1);

                                // total
                                var $cellTotalGas = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d7");
                                if ($cellTotalGas.length > 0) {
                                    // var cellTotalGasVal = parseFloat($.unformatMoney($cellTotalGas.html()));
                                    var cellTotalGasVal = parseFloat($cellTotalGas.html());
                                    if (isNaN(cellTotalGasVal)) {
                                        cellTotalGasVal = 0;
                                    } else {
                                        cellTotalGasVal = cellTotalGasVal.toFixed(0);
                                    }
                                    // $cellTotalGas.html($.formatMoney(cellTotalGasVal * 1 + gas * 1, 1));
                                    $cellTotalGas.html(cellTotalGasVal * 1 + gas * 1);

                                    var $cellTotalGas = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d11");
                                    if ($cellTotalGas.length > 0) {
                                        var cellTotalGasVal = parseFloat($cellTotalGas.html());
                                        if (isNaN(cellTotalGasVal)) {
                                            cellTotalGasVal = 0;
                                        } else {
                                            cellTotalGasVal = cellTotalGasVal.toFixed(0);
                                        }
                                        // $cellTotalGas.html($.formatMoney(cellTotalGasVal * 1 + gas * 1, 1));
                                        $cellTotalGas.html(cellTotalGasVal * 1 + gas * 1);
                                    }
                                }
                            } else {
                                var $cellGas = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d7");
                                // var cellGasVal = parseFloat($.unformatMoney($cellGas.html()));
                                var cellGasVal = parseFloat($cellGas.html());
                                if (isNaN(cellGasVal)) {
                                    cellGasVal = 0;
                                } else {
                                    cellGasVal = cellGasVal.toFixed(0);
                                }
                                //$cellGas.html($.formatMoney(cellGasVal * 1 + gas * 1, 0));
                                $cellGas.html(cellGasVal * 1 + gas * 1);

                                var $cellMoney = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d9");
                                // var cellMoneyVal = parseFloat($.unformatMoney($cellMoney.html()));
                                var cellMoneyVal = parseFloat($cellMoney.html());
                                if (isNaN(cellMoneyVal)) {
                                    cellMoneyVal = 0.00;
                                } else {
                                    cellMoneyVal = cellMoneyVal.toFixed(4);
                                }
                                // $cellMoney.html($.formatMoney(cellMoneyVal * 1 + gas * 1 * price, 2));
                                $cellMoney.html(parseFloat(cellMoneyVal * 1 + sse * 1).toFixed(2));

                                // total
                                var $cellTotalGas = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d7");
                                if ($cellTotalGas.length > 0) {
                                    // var cellTotalGasVal = parseFloat($.unformatMoney($cellTotalGas.html()));
                                    var cellTotalGasVal = parseFloat($cellTotalGas.html());
                                    if (isNaN(cellTotalGasVal)) {
                                        cellTotalGasVal = 0;
                                    } else {
                                        cellTotalGasVal = cellTotalGasVal.toFixed(0);
                                    }
                                    // $cellTotalGas.html($.formatMoney(cellTotalGasVal * 1 + gas * 1, 1));
                                    $cellTotalGas.html(cellTotalGasVal * 1 + gas * 1);

                                    var $cellTotalMoney = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d9");
                                    if ($cellTotalMoney.length > 0) {
                                        // var cellTotalMoneyVal = parseFloat($.unformatMoney($cellTotalMoney.html()));
                                        var cellTotalMoneyVal = parseFloat($cellTotalMoney.html());
                                        if (isNaN(cellTotalMoneyVal)) {
                                            cellTotalMoneyVal = 0.00;
                                        } else {
                                            cellTotalMoneyVal = cellTotalMoneyVal.toFixed(4);
                                        }
                                        // $cellTotalMoney.html($.formatMoney(cellTotalMoneyVal * 1 + gas * 1 * price, 2));
                                        $cellTotalMoney.html(parseFloat(cellTotalMoneyVal * 1 + sse * 1).toFixed(2));
                                    }
                                }
                            }
                        }
                        // 计算小计
                        $tbody.find("td[csum=d7]").html("0");
                        $tbody.find("td[csum=d7]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                                $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(0));
                            });
                        });

                        // 计算小计
                        $tbody.find("td[csum=d9]").html("0");
                        $tbody.find("td[csum=d9]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 2));
                                $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(2));
                            });
                        });

                        $tbody.find("td[csum=d11]").html("0");
                        $tbody.find("td[csum=d11]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                                $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(0));
                            });
                        });
                    }
                }
            });

            // 取实收
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(money) money,sum(ysl) ysl,areaId,gasTypeId",
                    froms: "gasReportSse",
                    wheres: whereClause2 + " group by areaId,gasTypeId",
                    page: "false",
                    // limit:1
                }),
                dataType: "json",
                success: function (data) {
                    if (data.rows) {
                        var rows = data.rows;
                        for (var i = 0; i < rows.length; i++) {
                            var money = rows[i].money ? parseFloat(rows[i].money).toFixed(4) : 0.0000;
                            var ysl = rows[i].ysl ? parseFloat(rows[i].ysl).toFixed(4) : 0.0000;

                            if (rows[i].areaId == "23") {
                                var $cellMoney = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d12");
                                //var cellMoneyVal = parseFloat($.unformatMoney($cellMoney.html()));
                                var cellMoneyVal = parseFloat($cellMoney.html());

                                if (isNaN(cellMoneyVal)) {
                                    cellMoneyVal = 0;
                                } else {
                                    cellMoneyVal = cellMoneyVal.toFixed(2);
                                }
                                //$cellMoney.html($.formatMoney(cellMoneyVal * 1 + money * 1, 2));
                                $cellMoney.html(parseFloat(cellMoneyVal * 1 + money * 1).toFixed(2));

                                var $cellMoney = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d8");
                                //var cellMoneyVal = parseFloat($.unformatMoney($cellMoney.html()));
                                var cellMoneyVal = parseFloat($cellMoney.html());

                                if (isNaN(cellMoneyVal)) {
                                    cellMoneyVal = 0;
                                } else {
                                    cellMoneyVal = cellMoneyVal.toFixed(2);
                                }
                                //$cellMoney.html($.formatMoney(cellMoneyVal * 1 + money * 1, 2));
                                $cellMoney.html(parseFloat(cellMoneyVal * 1 + money * 1).toFixed(2));

                                // total
                                var $cellTotalMoney = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d12");
                                if ($cellTotalMoney.length > 0) {
                                    //var cellTotalMoneyVal = parseFloat($.unformatMoney($cellTotalMoney.html()));
                                    var cellTotalMoneyVal = parseFloat($cellTotalMoney.html());
                                    if (isNaN(cellTotalMoneyVal)) {
                                        cellTotalMoneyVal = 0;
                                    } else {
                                        cellTotalMoneyVal = cellTotalMoneyVal.toFixed(2);
                                    }
                                    // $cellTotalMoney.html($.formatMoney(cellTotalMoneyVal * 1 + money * 1, 2));
                                    $cellTotalMoney.html(parseFloat(cellTotalMoneyVal * 1 + money * 1).toFixed(2));

                                    var $cellTotalMoney = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d8");
                                    // var cellTotalGasVal = parseFloat($.unformatMoney($cellTotalGas.html()));
                                    var cellTotalMoneyVal = parseFloat($cellTotalMoney.html());
                                    if (isNaN(cellTotalMoneyVal)) {
                                        cellTotalMoneyVal = 0;
                                    } else {
                                        cellTotalMoneyVal = cellTotalMoneyVal.toFixed(2);
                                    }
                                    // $cellTotalMoney.html($.formatMoney(cellTotalMoneyVal * 1 + money * 1, 2));
                                    $cellTotalMoney.html(parseFloat(cellTotalMoneyVal * 1 + money * 1).toFixed(2));
                                }
                            } else {
                                var $cellMoney = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d12");
                                //var cellMoneyVal = parseFloat($.unformatMoney($cellMoney.html()));
                                var cellMoneyVal = parseFloat($cellMoney.html());

                                if (isNaN(cellMoneyVal)) {
                                    cellMoneyVal = 0;
                                } else {
                                    cellMoneyVal = cellMoneyVal.toFixed(2);
                                }
                                //$cellMoney.html($.formatMoney(cellMoneyVal * 1 + money * 1, 2));
                                $cellMoney.html(parseFloat(cellMoneyVal * 1 + money * 1).toFixed(2));

                                var $cellGas = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d10");
                                //var cellGasVal = parseFloat($.unformatMoney($cellGas.html()));
                                var cellGasVal = parseFloat($cellGas.html());
                                if (isNaN(cellGasVal)) {
                                    cellGasVal = 0;
                                } else {
                                    cellGasVal = cellGasVal.toFixed(0);
                                }
                                //$cellGas.html($.formatMoney(parseFloat(cellGasVal * 1 + money / price).toFixed(0), 0));
                                $cellGas.html(parseFloat(cellGasVal * 1 + ysl * 1).toFixed(0));

                                //total
                                var $cellTotalMoney = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d12");
                                if ($cellTotalMoney.length > 0) {
                                    // var cellTotalMoneyVal = parseFloat($.unformatMoney($cellTotalMoney.html()));
                                    var cellTotalMoneyVal = parseFloat($cellTotalMoney.html());

                                    if (isNaN(cellTotalMoneyVal)) {
                                        cellTotalMoneyVal = 0;
                                    } else {
                                        cellTotalMoneyVal = cellTotalMoneyVal.toFixed(2);
                                    }
                                    //$cellTotalMoney.html($.formatMoney(cellTotalMoneyVal * 1 + money * 1, 2));
                                    $cellTotalMoney.html(parseFloat(cellTotalMoneyVal * 1 + money * 1).toFixed(2));

                                    var $cellTotalGas = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d10");
                                    //var cellTotalGasVal = parseFloat($.unformatMoney($cellTotalGas.html()));
                                    var cellTotalGasVal = parseFloat($cellTotalGas.html());
                                    if (isNaN(cellTotalGasVal)) {
                                        cellTotalGasVal = 0;
                                    } else {
                                        cellTotalGasVal = cellTotalGasVal.toFixed(0);
                                    }
                                    //$cellTotalGas.html($.formatMoney(parseFloat(cellTotalGasVal * 1 + money / price).toFixed(2), 0));
                                    $cellTotalGas.html(parseFloat(cellTotalGasVal * 1 + ysl * 1).toFixed(0));
                                }
                            }
                        }

                        // 计算小计
                        $tbody.find("td[csum=d12]").html("0");
                        $tbody.find("td[csum=d12]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                // $(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 2));
                                $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(2));
                            });
                        });

                        // 计算小计
                        $tbody.find("td[csum=d10]").html("0");
                        $tbody.find("td[csum=d10]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                //$(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                                $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(0));
                            });
                        });

                        // 计算小计
                        $tbody.find("td[csum=d8]").html("0");
                        $tbody.find("td[csum=d8]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                //$(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                                $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(2));
                            });
                        });
                    }
                }
            });


            // 取实收累计
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(money) money,sum(ysl) ysl,areaId,gasTypeId",
                    froms: "gasReportSse",
                    wheres: whereClause6 + " group by areaId,gasTypeId",
                    page: "false",
                    // limit:1
                }),
                dataType: "json",
                success: function (data) {
                    if (data.rows) {
                        var rows = data.rows;
                        for (var i = 0; i < rows.length; i++) {
                            var money = rows[i].money ? parseFloat(rows[i].money).toFixed(4) : 0.0000;
                            var ysl = rows[i].ysl ? parseFloat(rows[i].ysl).toFixed(4) : 0.0000;

                            if (rows[i].areaId == "23") {
                                var $cellMoney = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d13");
                                //var cellMoneyVal = parseFloat($.unformatMoney($cellMoney.html()));
                                var cellMoneyVal = parseFloat($cellMoney.html());
                                if (isNaN(cellMoneyVal)) {
                                    cellMoneyVal = 0;
                                } else {
                                    cellMoneyVal = cellMoneyVal.toFixed(4);
                                }
                                //$cellMoney.html($.formatMoney(cellMoneyVal * 1 + money * 1, 2));
                                $cellMoney.html(parseFloat(cellMoneyVal * 1 + money * 1).toFixed(2));

                                var $cellMoney = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d9");
                                //var cellMoneyVal = parseFloat($.unformatMoney($cellMoney.html()));
                                var cellMoneyVal = parseFloat($cellMoney.html());
                                if (isNaN(cellMoneyVal)) {
                                    cellMoneyVal = 0;
                                } else {
                                    cellMoneyVal = cellMoneyVal.toFixed(4);
                                }
                                //$cellMoney.html($.formatMoney(cellMoneyVal * 1 + money * 1, 2));
                                $cellMoney.html(parseFloat(cellMoneyVal * 1 + money * 1).toFixed(2));

                                //total
                                var $cellTotalMoney = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d13");
                                if ($cellTotalMoney.length > 0) {
                                    //var cellTotalMoneyVal = parseFloat($.unformatMoney($cellTotalMoney.html()));
                                    var cellTotalMoneyVal = parseFloat($cellTotalMoney.html());
                                    if (isNaN(cellTotalMoneyVal)) {
                                        cellTotalMoneyVal = 0;
                                    } else {
                                        cellTotalMoneyVal = cellTotalMoneyVal.toFixed(4);
                                    }
                                    //$cellTotalMoney.html($.formatMoney(cellTotalMoneyVal * 1 + money * 1, 2));
                                    $cellTotalMoney.html(parseFloat(cellTotalMoneyVal * 1 + money * 1).toFixed(2));

                                    var $cellTotalMoney = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d9");
                                    var cellTotalMoneyVal = parseFloat($cellTotalMoney.html());
                                    if (isNaN(cellTotalMoneyVal)) {
                                        cellTotalMoneyVal = 0;
                                    } else {
                                        cellTotalMoneyVal = cellTotalMoneyVal.toFixed(4);
                                    }
                                    //$cellTotalMoney.html($.formatMoney(cellTotalMoneyVal * 1 + money * 1, 2));
                                    $cellTotalMoney.html(parseFloat(cellTotalMoneyVal * 1 + money * 1).toFixed(2));
                                }
                            } else {
                                var $cellMoney = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d13");
                                //var cellMoneyVal = parseFloat($.unformatMoney($cellMoney.html()));
                                var cellMoneyVal = parseFloat($cellMoney.html());
                                if (isNaN(cellMoneyVal)) {
                                    cellMoneyVal = 0;
                                } else {
                                    cellMoneyVal = cellMoneyVal.toFixed(4);
                                }
                                //$cellMoney.html($.formatMoney(cellMoneyVal * 1 + money * 1, 2));
                                $cellMoney.html(parseFloat(cellMoneyVal * 1 + money * 1).toFixed(2));

                                var $cellGas = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d11");
                                //var cellGasVal = parseFloat($.unformatMoney($cellGas.html()));
                                var cellGasVal = parseFloat($cellGas.html());

                                if (isNaN(cellGasVal)) {
                                    cellGasVal = 0;
                                } else {
                                    cellGasVal = cellGasVal.toFixed(0);
                                }
                                //$cellGas.html($.formatMoney(parseFloat(cellGasVal * 1 + money / price).toFixed(4), 0));
                                $cellGas.html(parseFloat(cellGasVal * 1 + ysl * 1).toFixed(0));

                                //total
                                var $cellTotalMoney = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d13");
                                if ($cellTotalMoney.length > 0) {
                                    //var cellTotalMoneyVal = parseFloat($.unformatMoney($cellTotalMoney.html()));
                                    var cellTotalMoneyVal = parseFloat($cellTotalMoney.html());
                                    if (isNaN(cellTotalMoneyVal)) {
                                        cellTotalMoneyVal = 0;
                                    } else {
                                        cellTotalMoneyVal = cellTotalMoneyVal.toFixed(4);
                                    }
                                    //$cellTotalMoney.html($.formatMoney(cellTotalMoneyVal * 1 + money * 1, 2));
                                    $cellTotalMoney.html(parseFloat(cellTotalMoneyVal * 1 + money * 1).toFixed(2));

                                    var $cellTotalGas = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d11");
                                    //var cellTotalGasVal = parseFloat($.unformatMoney($cellTotalGas.html()));
                                    var cellTotalGasVal = parseFloat($cellTotalGas.html());
                                    if (isNaN(cellTotalGasVal)) {
                                        cellTotalGasVal = 0;
                                    } else {
                                        cellTotalGasVal = cellTotalGasVal.toFixed(0);
                                    }
                                    //$cellTotalGas.html($.formatMoney(parseFloat(cellTotalGasVal * 1 + money / price).toFixed(0), 0));
                                    $cellTotalGas.html(parseFloat(cellTotalGasVal * 1 + ysl * 1).toFixed(0));
                                }
                            }
                        }

                        // 计算小计
                        $tbody.find("td[csum=d13]").html("0");
                        $tbody.find("td[csum=d13]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                //$(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 2));
                                $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(2));
                            });
                        });

                        // 计算小计
                        $tbody.find("td[csum=d11]").html("0");
                        $tbody.find("td[csum=d11]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                //$(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                                $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(0));
                            });
                        });

                        // 计算小计
                        $tbody.find("td[csum=d9]").html("0");
                        $tbody.find("td[csum=d9]").each(function (index, element) {
                            $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                                //$(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 0));
                                $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(2));
                            });
                        });
                    }
                }
            });

            // 累计余额
            $.ajax({
                url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
                type: "POST",
                contentType: "application/json;charset=utf-8",
                data: JSON.stringify({
                    cols: "sum(balance) money ,areaId,gasTypeId",
                    froms: "gasReportLjye ",
                    wheres: whereClause4 + " and balance < 0 group by areaId,gasTypeId"
                }),
                dataType: "json",
                success: function (data) {
                    if (data.rows) {
                        var rows = data.rows;
                        for (var i = 0; i < rows.length; i++) {
                            var money = rows[i].money ? parseFloat(rows[i].money).toFixed(2) : 0.00;
                            if (rows[i].gasTypeId) {
                                var $cellCount = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d14");
                                if ($cellCount.length > 0) {
                                    //var cellCountVal = parseFloat($.unformatMoney($cellCount.html()));
                                    var cellCountVal = parseFloat($cellCount.html());
                                    if (isNaN(cellCountVal)) {
                                        cellCountVal = 0;
                                    } else {
                                        cellCountVal = cellCountVal.toFixed(2);
                                    }
                                    //$cellCount.html($.formatMoney(cellCountVal * 1 + money * 1, 2));
                                    $cellCount.html(parseFloat(cellCountVal * 1 + money * 1).toFixed(2));

                                    var $cellTotalCount = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d14");
                                    if ($cellTotalCount.length > 0) {
                                        //var cellTotalCountVal = parseFloat($.unformatMoney($cellTotalCount.html()));
                                        var cellTotalCountVal = parseFloat($cellTotalCount.html());
                                        if (isNaN(cellTotalCountVal)) {
                                            cellTotalCountVal = 0;
                                        } else {
                                            cellTotalCountVal = cellTotalCountVal.toFixed(2);
                                        }
                                        //$cellTotalCount.html($.formatMoney(cellTotalCountVal * 1 + money * 1, 2));
                                        $cellTotalCount.html(parseFloat(cellTotalCountVal * 1 + money * 1).toFixed(2));
                                    }

                                }
                            } else {
                            }
                        }
                    }

                    // 计算小计
                    $tbody.find("td[csum=d14]").html("0");
                    $tbody.find("td[csum=d14]").each(function (index, element) {
                        $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
                            //$(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 2));
                            $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(2));
                        });
                    });
                }
            });

            // // 取非联合账户欠费余额
            // $.ajax({
            //     url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
            //     type: "POST",
            //     contentType: "application/json;charset=utf-8",
            //     data: JSON.stringify({
            //         cols: "sum(lastMoney) money ,areaId,gasTypeId",
            //         froms: " (select row_number() over(partition by customer_code order by rn) rn1," +
            //         "a.* from vw_report_flhzh_ljye a " +
            //         " where " + whereClause4 +
            //         ") b ",
            //         wheres: "b.rn1 = 1  and lastMoney < 0 group by areaId,gasTypeId"
            //     }),
            //     dataType: "json",
            //     success: function (data) {
            //         if (data.rows) {
            //             var rows = data.rows;
            //             for (var i = 0; i < rows.length; i++) {
            //                 var money = rows[i].money ? parseFloat(rows[i].money).toFixed(2) : 0.00;
            //                 if (rows[i].gasTypeId) {
            //                     var $cellCount = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d14");
            //                     if ($cellCount.length > 0) {
            //                         //var cellCountVal = parseFloat($.unformatMoney($cellCount.html()));
            //                         var cellCountVal = parseFloat($cellCount.html());
            //                         if (isNaN(cellCountVal)) {
            //                             cellCountVal = 0;
            //                         } else {
            //                             cellCountVal = cellCountVal.toFixed(2);
            //                         }
            //                         //$cellCount.html($.formatMoney(cellCountVal * 1 + money * 1, 2));
            //                         $cellCount.html(parseFloat(cellCountVal * 1 + money * 1).toFixed(2));

            //                         var $cellTotalCount = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d14");
            //                         if ($cellTotalCount.length > 0) {
            //                             //var cellTotalCountVal = parseFloat($.unformatMoney($cellTotalCount.html()));
            //                             var cellTotalCountVal = parseFloat($cellTotalCount.html());
            //                             if (isNaN(cellTotalCountVal)) {
            //                                 cellTotalCountVal = 0;
            //                             } else {
            //                                 cellTotalCountVal = cellTotalCountVal.toFixed(2);
            //                             }
            //                             //$cellTotalCount.html($.formatMoney(cellTotalCountVal * 1 + money * 1, 2));
            //                             $cellTotalCount.html(parseFloat(cellTotalCountVal * 1 + money * 1).toFixed(2));
            //                         }

            //                     }
            //                 } else {
            //                 }
            //             }
            //         }

            //         // 取联合账户欠费余额
            //         $.ajax({
            //             url: "hzqs/dbc/pbsel.do?fh=SELDBC0000000J00&resp=bd",
            //             type: "POST",
            //             contentType: "application/json;charset=utf-8",
            //             data: JSON.stringify({
            //                 cols: "sum(lastMoney) money, areaId, gasTypeId",
            //                 froms: " (select row_number() over(partition by chg_account_no order by rn) rn1," +
            //                 "a.* from vw_report_lhzh_ljye a " +
            //                 " where " + whereClause4 +
            //                 ") b ",
            //                 wheres: "b.rn1 = 1  and lastMoney < 0 group by areaId,gasTypeId",
            //                 page: "false",
            //             }),
            //             dataType: "json",
            //             success: function (data) {
            //                 if (data.rows) {
            //                     var rows = data.rows;
            //                     for (var i = 0; i < rows.length; i++) {
            //                         var money = rows[i].money ? parseFloat(rows[i].money).toFixed(2) : 0.00;
            //                         if (rows[i].gasTypeId) {
            //                             var $cellCount = $tbody.find("#tbody_r" + rows[i].areaId + "_c" + rows[i].gasTypeId.substring(0, 3) + "_d14");
            //                             if ($cellCount.length > 0) {
            //                                 //var cellCountVal = parseFloat($.unformatMoney($cellCount.html()));
            //                                 var cellCountVal = parseFloat($cellCount.html());
            //                                 if (isNaN(cellCountVal)) {
            //                                     cellCountVal = 0;
            //                                 } else {
            //                                     cellCountVal = cellCountVal.toFixed(2);
            //                                 }
            //                                 //$cellCount.html($.formatMoney(cellCountVal * 1 + money * 1, 2));
            //                                 $cellCount.html(parseFloat(cellCountVal * 1 + money * 1).toFixed(2));
            //                                 var $cellTotalCount = $tbody.find("#tbody_r1_c" + rows[i].gasTypeId.substring(0, 3) + "_d14");
            //                                 //var cellTotalCountVal = parseFloat($.unformatMoney($cellTotalCount.html()));
            //                                 var cellTotalCountVal = parseFloat($cellTotalCount.html());
            //                                 if (isNaN(cellTotalCountVal)) {
            //                                     cellTotalCountVal = 0;
            //                                 } else {
            //                                     cellTotalCountVal = cellTotalCountVal.toFixed(2);
            //                                 }
            //                                 //$cellTotalCount.html($.formatMoney(cellTotalCountVal * 1 + money * 1, 2));
            //                                 $cellTotalCount.html(parseFloat(cellTotalCountVal * 1 + money * 1).toFixed(2));
            //                             }
            //                         } else {
            //                         }
            //                     }

            //                     // 计算小计
            //                     $tbody.find("td[csum=d14]").html("0");
            //                     $tbody.find("td[csum=d14]").each(function (index, element) {
            //                         $tbody.find("td[csumtype=" + $(element).attr("csumtypeid") + "]").each(function (i, e) {
            //                             //$(element).html($.formatMoney($.unformatMoney($(e).html()) * 1 + $.unformatMoney($(element).html()) * 1, 2));
            //                             $(element).html(parseFloat($(e).html() * 1 + $(element).html() * 1).toFixed(2));
            //                         });
            //                     });
            //                 }
            //             }
            //         });
            //     }
            // });

            $("#find_sign").removeAttr("disabled", "disabled");
        });
    });

</script>
<!-- End of User Script-->

</html>